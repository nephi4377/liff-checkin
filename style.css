/*
* 版本: v12.0 (Refactored)
* 修改時間: 2025-09-26 17:50 (Asia/Taipei)
* 說明: 從 HTML 中分離出的獨立 CSS 檔案。
*/
:root {
  --bg:#e5e7eb; --fg:#111827; --muted:#4b5563; --muted-2:#9ca3af; --card:#ffffff;
  /* 【⭐️ 核心修正：更換為低飽和度的莫蘭迪色系 ⭐️】 */
  --primary: #8fa8b7; /* 莫蘭迪藍 (主色) */
  --primary-hover: #7c95a5; /* 懸停顏色 */
  --red: #d3a398; /* 莫蘭迪紅 (用於刪除/危險操作) */
  --red-hover: #c08e85; /* 懸停顏色 */
  --green:#879f86; --green-hover:#738a72; --yellow:#f59e0b; --secondary: #a1a1aa; --secondary-hover: #71717a;
  --shadow:0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
  --radius:.5rem;
}
*{box-sizing:border-box}
html, body {
  height: 100%; /* 讓根元素佔滿整個視窗高度 */
  overflow: hidden; /* 隱藏 body 的捲軸 */
}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;background:var(--bg);color:var(--fg);margin:0;}
.container{
  max-width:1400px;
  margin:0 auto;
  height: 100%;
  display: flex;
  flex-direction: column;
  padding: 1.5rem;
}

header{margin-bottom:1.5rem;display:flex;align-items:center;gap:.75rem;flex-wrap:wrap}
h1{font-size:1.75rem;font-weight:700;margin:0}
h3 { font-size: 1.25rem; font-weight: 600; margin: 0; }
.muted{color:var(--muted);font-size:inherit} /* [修改] 讓 muted 繼承父層字體大小 */
.card{background:var(--card);border-radius:var(--radius);padding:1.25rem;margin-bottom:1rem;box-shadow:var(--shadow)} /* [修改] 縮小卡片 padding */
.spinner{margin:2rem auto;width:3rem;height:3rem;border-radius:50%;border:4px solid #e5e7eb;border-top-color:var(--primary);animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
pre#debug-log{background:#111827;color:#e5e7eb;font-family:monospace;font-size:.75rem;padding:1rem;border-radius:var(--radius);margin-top:1rem;height:16rem;overflow-y:auto;white-space:pre-wrap}
hr { border: 0; border-top: 1px solid #e5e7eb; margin: 1rem 0; }

/* 照片牆 */
.photo-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:.75rem;margin-top:1rem}
.photo-item{display:flex;flex-direction:column;gap:.25rem}
.log-card-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  gap: 0.75rem;
}
/* 【⭐️ 核心新增：日誌卡片底部按鈕佈局 ⭐️】 */
.log-card-footer {
  display: flex;
  justify-content: flex-end; /* 靠右對齊 */
  gap: 0.5rem; /* 按鈕間距 */
}
.log-card-header .muted { color: var(--muted); }
.photo-thumb{width:100%;aspect-ratio:4/3;object-fit:cover;background:#e5e7eb;border-radius:.5rem;display:block;cursor:zoom-in}
.photo-placeholder{width:100%;aspect-ratio:4/3;border-radius:.5rem;background:#f3f4f6;display:flex;align-items:center;justify-content:center;color:var(--muted-2);font-size:.9rem;text-align:center;padding:0 .5rem}

/* [重構] 通用按鈕樣式 */
.btn { border:0; padding:.5rem 1rem; border-radius:.375rem; cursor:pointer; font-weight:600; transition:opacity .2s; }
.btn:hover { opacity:.85; }
.btn:active { transform: translateY(1px); } /* 增加點擊回饋 */
.btn[disabled] { opacity:.6; cursor:not-allowed; }
.btn-primary { background:var(--primary); color:#fff; }
.btn-primary:hover { background: var(--primary-hover); opacity: 1; }
.btn-danger { background:var(--red); color:#fff; }
.btn-danger:hover { background: var(--red-hover); opacity: 1; }
/* 【⭐️ 核心新增：為新增與次要按鈕定義新的 class ⭐️】 */
.btn-green { background: var(--green); color: #fff; }
.btn-green:hover { background: var(--green-hover); opacity: 1; }
.btn-secondary { background: var(--secondary); color: #fff; }
.btn-secondary:hover { background: var(--secondary-hover); opacity: 1; }

/* 【⭐️ 核心修正 1/2：覆蓋舊的按鈕樣式，確保新顏色生效 ⭐️】 */
button{background:var(--primary);color:#fff;border:0;padding:.5rem .75rem;border-radius:.375rem;cursor:pointer;font-weight:600;transition:opacity .2s}
button:hover{background: var(--primary-hover); opacity: 1; transform: translateY(-1px);}
button[disabled]{opacity:.6;cursor:not-allowed}

/* 【⭐️ 核心修正：移除 float 佈局，回歸單純的 Flexbox ⭐️】 */
.button-group {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
  justify-content: flex-end; /* 讓所有按鈕靠右對齊 */
  margin-top: 1rem;
}

/* [新增] 無障礙輔助：隱藏元素但保留給螢幕報讀軟體 */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* 進度總覽 */
.progress-timeline{position:relative;width:100%;height:18px;background:#e5e7eb;border-radius:9px;overflow:hidden;margin:.5rem 0}
.progress-segment{position:absolute;height:100%}
.today-marker{position:absolute;top:-5px;width:3px;height:28px;background:var(--red);border-radius:2px;box-shadow:0 0 5px rgba(0,0,0,.3)}
.today-marker::after{content:'今天';position:absolute;top:-20px;left:50%;transform:translateX(-50%);font-size:12px;color:var(--red);font-weight:700;background:#fff;padding:0 3px;border-radius:3px}
.progress-label{font-size:.9rem}
.schedule-table{width:100%;border-collapse:collapse;font-size:14px}

/* [重構] 排程列表 */
.schedule-list { display: flex; flex-direction: column; gap: 1rem; }

/* [重構] 表單元件樣式 */
.form-label { font-size: .75rem; color: var(--muted); font-weight: 600; }
.form-input, .form-select, .form-textarea { width: 100%; padding: .5rem; border-radius: .375rem; border: 1px solid #d1d5db; font-family: inherit; font-size: .875rem; background-color: #f9fafb; box-shadow: inset 0 1px 2px rgba(0,0,0,0.05); }
.form-textarea { min-height: 60px; resize: vertical; }

/* [重構] 階段標籤 */
.phase-tag {
  font-size: .7rem;
  font-weight: 700;
  padding: .1rem .4rem;
  border-radius: .25rem;
  background-color: #e0e7ff; /* 淺藍色 */
  color: #3730a3; /* 深藍色 */
  display: inline-block;
  margin-bottom: .25rem;
}

/* [重構] 狀態選擇器 */
.status-cell { border-radius: .375rem; text-align: center; }
.status-cell .form-select { background: transparent; border: none; font-weight: bold; text-align: center; -webkit-appearance: none; appearance: none; padding: .25rem; }

/* [重構] 刪除按鈕 */
.delete-task-btn { background-color: transparent; color: #9ca3af; border: none; cursor: pointer; font-size: 1.5rem; line-height: 1; position: absolute; top: .5rem; right: .5rem; padding: 0 .5rem; }
.delete-task-btn:hover { color: #b91c1c; }

.add-task-controls {
  position: sticky;
  bottom: 0;
  backdrop-filter: blur(4px);
  z-index: 10;
}

.status-未完成 { background-color: #f3f4f6; color: #4b5563; }
.status-施工中 { background-color: #dbeafe; color: #1e40af; }
.status-已完成 { background-color: #dcfce7; color: #166534; }

.schedule-table th{background:#f9fafb;font-weight:600;position:sticky;top:0;z-index:1}
.schedule-table tr:last-child td{border-bottom:none}
.status-badge{font-weight:700;padding:.25rem .5rem;border-radius:99px;font-size:12px;display:inline-block}
.clickable-work-type{cursor:pointer;text-decoration:underline;color:var(--primary)}

/* ===== Utility Classes (Tailwind-inspired) ===== */
.hidden { display: none; }
.relative { position: relative; }
.p-0 { padding: 0; }
.p-4 { padding: 1rem; }
.p-6 { padding: 1.5rem; }
.mt-1 { margin-top: 0.25rem; }
.text-center { text-align: center; }
.font-semibold { font-weight: 600; }
.bg-white { background-color: #fff; }
.bg-gray-50 { background-color: #f9fafb; }
.border { border-width: 1px; border-color: #e5e7eb; }
.border-b { border-bottom-width: 1px; border-color: #e5e7eb; }
.border-t { border-top-width: 1px; border-color: #e5e7eb; }
.rounded-lg { border-radius: .5rem; }
.rounded-md { border-radius: .375rem; }
.shadow { box-shadow: var(--shadow); }

/* Flex & Grid */
.flex { display: flex; }
.grid { display: grid; }
.flex-col { flex-direction: column; }
.items-center { align-items: center; }
.justify-end { justify-content: flex-end; }
.gap-1 { gap: 0.25rem; }
.gap-4 { gap: 1rem; }

/* Responsive Grid */
.grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
@media (min-width: 768px) {
  .md\:grid-cols-5 { grid-template-columns: repeat(5, minmax(0, 1fr)); }
  .md\:col-span-2 { grid-column: span 2 / span 2; }
}

/* Task Card specific responsive adjustments */
@media (max-width: 767px) {
  .task-card { grid-template-columns: 1fr 1fr; }
  .task-card .md\:col-span-2 { grid-column: 1 / -1; }
}
/* ========== 新增：三欄式佈局 ========== */
.app-layout {
  display: grid;
  grid-template-columns: 240px 1fr 280px;
  gap: 1.5rem;
  align-items: stretch; /* 讓欄位等高 */
  flex-grow: 1; /* 佔滿剩餘空間 */
  overflow: hidden; /* 避免自身產生捲軸 */
}

/* [新增] 修正中欄在切換內容時的寬度抖動問題 */
/* [修改] 為三個欄位加上獨立捲動 */
.left-sidebar,
#main-content,
.right-sidebar {
  width: 100%;
  overflow-y: auto; /* 內容超出時，顯示自己的捲軸 */
  scrollbar-width: none; /* For Firefox */
  -ms-overflow-style: none;  /* For Internet Explorer and Edge */
}

/* [新增] 隱藏 Webkit 瀏覽器 (Chrome, Safari) 的捲動條 */
.left-sidebar::-webkit-scrollbar,
#main-content::-webkit-scrollbar,
.right-sidebar::-webkit-scrollbar {
  display: none;
}

.left-sidebar .main-nav {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.nav-button {
  display: flex;
  align-items: center;
  width: 100%;
  padding: 0.75rem 1rem;
  font-size: 1rem;
  font-weight: 600;
  text-align: left;
  background-color: transparent;
  color: var(--muted);
  border: none;
  border-radius: var(--radius);
}
.nav-button:hover {
  background-color: var(--card);
  color: var(--fg);
}
/* [修改] 讓啟用中的按鈕樣式更明顯 */
.nav-button.active {
  background-color: var(--card);
  color: var(--primary);
  font-weight: 700; /* 加粗文字 */
  border-left: 4px solid var(--primary); /* 左側加上高亮邊框 */
}

/* 照片管理 Modal */
.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background:rgba(0,0,0,.6);align-items:center;justify-content:center}
.modal-content{background:#fefefe;padding:20px;border-radius:.5rem;width:90%;max-width:800px;box-shadow:0 4px 20px rgba(0,0,0,.4)}
.modal-photo-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:10px;max-height:60vh;overflow-y:auto;padding:1rem;background:#f3f4f6;border-radius:var(--radius)}
.modal-photo-item{position:relative}
.modal-photo-item img{width:100%;aspect-ratio:4/3;object-fit:cover;border-radius:.25rem}
.delete-photo-btn{position:absolute;top:5px;right:5px;background:rgba(239,68,68,.8);color:#fff;border:2px solid #fff;border-radius:50%;width:28px;height:28px;cursor:pointer;font-weight:700;font-size:16px;display:flex;align-items:center;justify-content:center;line-height:1;transition:transform .2s}
.delete-photo-btn:hover{transform:scale(1.1)}

/* Lightbox */
#lightbox{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;z-index:9999;padding:1rem}
#lightbox.open{display:flex}
#lightbox .lb-wrap{position:relative;max-width:98vw;max-height:95vh;display:flex;align-items:center;justify-content:center}
#lightbox img.lb-img{display:block;max-width:98vw;max-height:95vh;object-fit:contain;border-radius:.5rem;background:#fff;box-shadow:0 4px 20px rgba(0,0,0,.6)}
#lightbox button.lb-close{position:absolute;top:-.5rem;right:-.5rem;background:rgba(0,0,0,.6);color:#fff;border:0;border-radius:9999px;width:40px;height:40px;cursor:pointer;font-size:20px;line-height:40px;text-align:center}
/* [新增] 燈箱左右導覽按鈕樣式 */
#lightbox .lb-prev, #lightbox .lb-next {
  position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,.4); color: #fff; border: none; border-radius: 50%; width: 44px; height: 44px; font-size: 24px; cursor: pointer; transition: background .2s;
}
#lightbox .lb-prev { left: 1rem; }
#lightbox .lb-next { right: 1rem; }
#lightbox .lb-prev:hover, #lightbox .lb-next:hover { background: rgba(0,0,0,.7); }

/*
* 版本: v12.4
* 修改時間: 2025-09-27 10:24 (Asia/Taipei)
* 說明: 新增骨架屏 (Skeleton Screen) 相關樣式。
*/

/* 骨架屏容器 */
.skeleton-wrapper {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

/* 骨架卡片 */
.skeleton-card {
  background-color: #ffffff;
  border-radius: var(--radius);
  padding: 1.5rem;
  box-shadow: var(--shadow);
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

/* 骨架線條 */
.skeleton {
  background-color: #e5e7eb;
  border-radius: 0.25rem;
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* 脈動動畫 */
@keyframes pulse {
  50% {
    opacity: .5;
  }
}

.skeleton.title {
  width: 40%;
  height: 1.75rem;
  margin-bottom: 0.5rem;
}

.skeleton.line {
  width: 100%;
  height: 0.875rem;
}

.skeleton.line-short {
  width: 60%;
  height: 0.875rem;
}

/* ========== 新增：漢堡選單按鈕 ========== */
.mobile-nav-toggle {
  display: none; /* 預設隱藏 */
  position: fixed;
  top: 1rem;
  left: 1rem;
  z-index: 1001;
  background: var(--card);
  border: 1px solid #e5e7eb;
  border-radius: 50%;
  width: 44px;
  height: 44px;
  padding: 0;
  box-shadow: var(--shadow);
  /* [新增] 使用 Flexbox 確保圖示完美置中 */
  display: flex;
  align-items: center;
  justify-content: center;
}
/* [重建] 漢堡圖示樣式，確保置中 */
.hamburger-icon {
  position: relative;
  width: 20px;
  height: 2px;
  background-color: var(--fg); /* 中間的橫線 */
}
.hamburger-icon::before, .hamburger-icon::after {
  content: '';
  position: absolute;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: var(--fg); /* 上下的橫線 */
  transition: all 0.3s;
}
.hamburger-icon::before { transform: translateY(-6px); }
.hamburger-icon::after { transform: translateY(6px); }
/* ========== 新增：三欄式響應式 ========== */
@media (max-width: 1024px) {
  body { padding-top: 4rem; } /* 避免內容被 header 蓋住 */
  .mobile-nav-toggle { display: flex; } /* [修改] 在手機上顯示漢堡按鈕，並使用 flex 置中 */
  .app-layout {
    grid-template-columns: 1fr; /* 在平板與手機上變為單欄 */
  }
  .left-sidebar {
    position: fixed;
    top: 0; left: 0; bottom: 0;
    transform: translateX(-100%);
    transition: transform 0.3s ease-in-out;
    background: var(--bg);
    padding: 60px 1rem 1rem 1rem; z-index: 1000; box-shadow: 0 0 20px rgba(0,0,0,0.2);
  }
  .add-task-controls { display: none; } /* 手機版隱藏桌面版的新增區塊 */
  .left-sidebar.open {
    transform: translateX(0);
  }
  .right-sidebar {
    display: none; /* 右側欄在手機上暫時不顯示 */
  }
}

/* ========== 新增：右側資訊面板樣式 ========== */
.project-info-section {
  margin-bottom: 1rem;
}
.info-header {
  font-size: 1.1rem;
  font-weight: 700;
  margin-bottom: 0.75rem;
  color: var(--fg);
}
.info-list {
  list-style: none;
  padding: 0;
  margin: 0;
  font-size: 0.9rem;
  color: var(--muted);
}
.info-list li { margin-bottom: 0.5rem; line-height: 1.4; }
.info-list strong { color: var(--fg); }
.info-list a { color: var(--primary); text-decoration: none; }
.info-list a:hover { text-decoration: underline; }
.info-divider {
  border: 0;
  border-top: 1px solid #e5e7eb;
  margin: 1.25rem 0;
}

/* ========== 新增：專案牆發文區塊樣式 ========== */
.post-creator {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}
.post-creator-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.action-buttons {
  display: flex;
  gap: 0.5rem;
}
.action-btn {
  display: flex;
  align-items: center;
  gap: 0.25rem;
  background-color: #f3f4f6;
  color: var(--muted);
  padding: 0.3rem 0.6rem; /* 縮小按鈕尺寸 */
  border-radius: 9999px; /* 圓角膠囊形狀 */
  font-size: 0.875rem;
}
.action-btn:hover { background-color: #e5e7eb; }
.action-btn svg { width: 1.1rem; height: 1.1rem; }

/* ===== 新增：新日誌照片預覽 ===== */
.photo-preview-container {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 12px;
}

.photo-preview-item {
  width: 80px;
  height: 80px;
  border-radius: 8px;
  background-size: cover;      /* 讓圖片填滿容器，可能會裁切 */
  background-position: center; /* 圖片置中顯示 */
  background-repeat: no-repeat;
  position: relative;
  overflow: hidden;
  border: 1px solid #e5e7eb;
}

.remove-preview-btn {
  position: absolute;
  top: 2px;
  right: 2px;
  width: 20px;
  height: 20px;
  background-color: rgba(0, 0, 0, 0.6);
  color: white;
  border: none;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  line-height: 1;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.photo-preview-item:hover .remove-preview-btn {
  opacity: 1;
}
