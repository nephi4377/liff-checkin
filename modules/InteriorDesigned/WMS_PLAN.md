# 員工工作排程系統 (WMS) 完整開發計劃書

## 1. 系統定位
專為「添心室內裝修」設計，解決多專案併行、工期聯動推移、以及人力資源重疊（並行任務）的調度平台。

## 2. 資料對接架構 (Existing System Integration)
系統不重新建立員工清單，而是透過 GAS 讀取原有的 Sheet。

*   **員工資料對接**： 透過 `SpreadsheetApp.openById(ORIGINAL_SSID)` 直接調用員工姓名、組別、職級。（可參考現有 `CheckinSystem` 的 `EmployeeLogic.js`）
*   **案場資料對接**： 若有現成的專案表，可同步「案場編號」與「案場地點」，確保排程時直接下拉選取，不需手動輸入。（可參考現有 `project-console` 的 `SiteLogic.js`）

## 3. 關鍵排程項目設計 (Task Properties)
除了基本時間外，針對裝修產業需具備以下屬性：

| 項目 | 說明 | 備註 |
| :--- | :--- | :--- |
| **案場名稱/編號** | 關聯至合約或客戶表單 | 下拉選單 |
| **任務類別** | 場勘、放樣、拆除、水電、木作、油漆、系統櫃、驗收等 | 顏色區分標籤 |
| **優先等級** | 1 (緊急) ~ 5 (一般) | 決定推移時的權重 |
| **前置關聯任務** | 此任務必須在某項任務結束後開始 | 聯動推移的核心依據 |
| **並行索引 (1-5)** | 標記該員工在同一時段的第幾個任務 | 支援最高 5 項並行 |
| **週期性標記** | 每日、每週、每月、自定義週期 | 自動產生邏輯用 |
| **施工圖/備註** | 附件連結或文字說明 | 方便現場人員點擊查看 |

## 4. 核心功能模組

### A. 智慧推移演算法 (Smart Shifting)
*   **插單邏輯**： 當總監在 A 同學的週三下午插入一個「緊急場勘」，系統偵測到衝突後，會將週三下午原定的「繪製施工圖」自動往後推 2 小時。
*   **連鎖反應**： 若推移導致超過當日下班時間 (如 18:00)，剩餘任務自動轉至隔日 09:00 開始。

### B. 視覺化界面
*   **甘特圖模式 (Gantt View)**： 依案場查看所有參與工種的進度。
*   **資源熱點模式 (Heatmap)**： 查看哪位員工的並行任務已達 5 項上限，避免過度操勞。
*   **歷史回顧**： 支援一鍵導出某案場的所有工期記錄，作為結案檢討。

## 5. 技術實施路徑 (Roadmap)

### Phase 1: 環境配置 (Week 1)
*   建立 Google Sheet 緩衝表（儲存任務記錄）。
*   編寫 GAS API 連接原有員工資料表。
*   定義 JSON 資料交換格式。

### Phase 2: 前端開發 (Week 2)
*   開發響應式網頁（Vue.js 或 React）。
*   實作「個人週視圖」與「組別總覽」視窗。
*   設計「拖拉式」任務塊，支援手動微調時間。

### Phase 3: 推移演算法與並行控制 (Week 3)
*   編寫 GAS 後端邏輯：處理 5 項任務並行的排版演算法。
*   編寫推移邏輯：處理任務插入後的 StartTime 重算。
*   實作週期性任務觸發器。

### Phase 4: 整合測試與上線 (Week 4)
*   對接 3D 渲染與施工圖繪製的實際工作流。
*   多裝置測試（現場員工用手機看，總監用平板/電腦調度）。

## 6. 安全與權限控制
*   **管理員 (總監)**： 擁有所有案場、所有人的人力調度權，可刪除/修改歷史。
*   **組長**： 可調整該組內員工人務。
*   **一般員工**： 僅能查看排程、點擊「任務完成」、上傳施工現場快照。

## 7. 未來擴展性
*   **自動預警**： 若某案場連續延誤超過 3 天，系統自動發送 Email 提醒總監。
*   **工時統計**： 結合排程數據，自動計算每個專案的人力成本。