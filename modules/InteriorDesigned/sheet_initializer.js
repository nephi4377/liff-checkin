/**
 * v2.3 - 2025-12-16 15:44 (Asia/Taipei)
 * 添心室內裝修設計 - 裝修檢核小幫手資料庫初始化腳本
 * 
 * [更新重點]
 * 1. 修正資料陣列結構 (材料與工具分開)。
 * 2. DB_Materials 擴充至 200 項，description 改為 note。
 * 3. DB_Tools 維持 100 項。
 * 4. 新增 t_basic 木作基本進場工具配方 (22 項工具)。
 */

function setupDatabase() {
    const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
    const sheetsConfig = [
        {
            name: "DB_Materials",
            headers: ["mat_id", "category", "name", "spec_order", "brand", "unit", "vendor_ref", "price_estimate", "pack_desc", "note"]
        },
        {
            name: "DB_Tools",
            headers: ["tool_id", "category", "name", "power_spec", "alloc_rule", "storage_box", "maintenance", "usage_tips"]
        },
        {
            name: "DB_Tasks",
            headers: ["task_id", "category", "phase", "task_name", "unit", "labor_cost", "sop_construction", "inspection_key", "inspection_sample"]
        },
        {
            name: "Map_Task_Materials",
            headers: ["task_id", "task_name", "mat_id", "spec", "qty_per_unit", "loss_rate", "is_consumable", "linked_tool_id"]
        },
        {
            name: "Map_Task_Tools",
            headers: ["task_id", "task_name", "tool_id", "type", "qty_avg", "calc_method"]
        },
        {
            name: "Logs",
            headers: ["timestamp", "project_name", "input_summary", "total_cost_est", "status"]
        }
    ];

    sheetsConfig.forEach(config => {
        let sheet = spreadsheet.getSheetByName(config.name);
        if (!sheet) {
            sheet = spreadsheet.insertSheet(config.name);
            console.log(`[建立] 分頁: ${config.name}`);
            const headerRange = sheet.getRange(1, 1, 1, config.headers.length);
            headerRange.setValues([config.headers]);
            headerRange.setFontWeight("bold");
            headerRange.setBackground("#E0E0E0");
            sheet.setFrozenRows(1);
        } else {
            const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
            if (headers.length < config.headers.length) {
                sheet.getRange(1, 1, 1, config.headers.length).setValues([config.headers]);
            }
        }
    });

    const defaultSheet = spreadsheet.getSheetByName("工作表1");
    if (defaultSheet && spreadsheet.getSheets().length > 1) {
        try { spreadsheet.deleteSheet(defaultSheet); } catch (e) { }
    }
    console.log("資料庫結構已更新 (無彈窗)");
}

function seedSampleData() {
    const ss = SpreadsheetApp.getActiveSpreadsheet();

    // ==========================================
    // 1. DB_Materials (200項：全工種)
    // ==========================================
    const materials = [
        // --- A. 角材與結構 (Timber & Framing) ---
        ["m_lv_12_8", "角材", "集層角材 (12)", "1寸2 x 8尺", "永新F1", "支", "建材行A", 65, "1捆10支", "低甲醛，結構穩定，天花板骨架主力"],
        ["m_lv_12_12", "角材", "集層角材 (12)", "1寸2 x 12尺", "永新F1", "支", "建材行A", 100, "1捆10支", "長跨距使用，減少接點"],
        ["m_lv_18_8", "角材", "集層角材 (18)", "1寸8 x 8尺", "永新F1", "支", "建材行A", 95, "1捆10支", "加強結構，門框或隔間立柱"],
        ["m_pvc_12", "角材", "PVC防腐角材", "1寸2 x 8尺", "南亞", "支", "建材行A", 120, "1捆20支", "浴室天花板專用，防水不腐爛"],
        ["m_solid_liu", "角材", "柳安實木角材", "1寸2 x 8尺", "進口", "支", "建材行A", 80, "1捆10支", "咬釘力強，但易變形，需挑選"],

        // --- B. 矽酸鈣板 (Silicate Board) ---
        ["m_sil_6_36", "板材", "矽酸鈣板", "6mm 3x6尺", "日本麗仕", "張", "建材行A", 320, "", "天花板封板首選，倒角容易"],
        ["m_sil_9_36", "板材", "矽酸鈣板", "9mm 3x6尺", "日本麗仕", "張", "建材行A", 480, "", "隔間牆封板，隔音較佳"],
        ["m_sil_9_48", "板材", "矽酸鈣板", "9mm 4x8尺", "日本麗仕", "張", "建材行A", 650, "", "挑高隔間用，減少接縫"],
        ["m_sil_6_tw", "板材", "矽酸鈣板 (台)", "6mm 3x6尺", "南亞", "張", "建材行A", 260, "", "經濟型選擇"],

        // --- C. 夾板 (Plywood) ---
        ["m_ply_1_36", "板材", "夾板 (1分)", "3mm 3x6尺", "F3", "張", "建材行A", 140, "", "背板、曲面造型底板"],
        ["m_ply_2_36", "板材", "夾板 (2分)", "5mm 3x6尺", "F3", "張", "建材行A", 220, "", "地板底板、牆面底板"],
        ["m_ply_3_36", "板材", "夾板 (3分)", "9mm 3x6尺", "F3", "張", "建材行A", 380, "", "結構補強、抽屜牆板"],
        ["m_ply_4_36", "板材", "夾板 (4分)", "12mm 3x6尺", "F3", "張", "建材行A", 480, "", "櫃體結構、抽屜底板"],
        ["m_ply_5_36", "板材", "夾板 (5分)", "15mm 3x6尺", "F3", "張", "建材行A", 580, "", "地板底板(加厚)、櫃體"],
        ["m_ply_6_48", "板材", "夾板 (6分)", "18mm 4x8尺", "F1紅膠", "張", "建材行A", 950, "", "高規防水，浴室櫃體底材"],
        ["m_ply_birch", "板材", "樺木夾板", "18mm 4x8尺", "進口", "張", "建材行B", 2200, "", "直接做面材使用，切面美觀"],

        // --- D. 木心板 (Wood Core Board) ---
        ["m_core_raw", "板材", "木心板 (麻六甲)", "6分 4x8尺", "F3", "張", "建材行A", 850, "", "一般櫃體桶身，重量較輕"],
        ["m_core_liu", "板材", "木心板 (柳安芯)", "6分 4x8尺", "F1", "張", "建材行A", 1050, "", "結構強韌，咬釘力佳，適合乘重"],
        ["m_core_poly1", "板材", "單面波麗木心板", "6分 4x8尺", "白霧", "張", "建材行A", 1100, "", "櫃體內部免油漆"],
        ["m_core_poly2", "板材", "雙面波麗木心板", "6分 4x8尺", "白霧", "張", "建材行A", 1250, "", "櫃體隔板，雙面皆免油漆"],

        // --- E. 表面飾材 (Surfaces) ---
        ["m_veneer_oak", "面材", "不織布實木皮", "2x8尺", "白橡木-直", "張", "建材行C", 600, "", "需上漆，質感溫潤"],
        ["m_veneer_wal", "面材", "不織布實木皮", "2x8尺", "胡桃木-山", "張", "建材行C", 850, "", "深色沉穩"],
        ["m_lam_std", "面材", "美耐板", "4x8尺 x 1.0mm", "富美家", "張", "建材行C", 1200, "", "耐磨耐刮，檯面或門片"],
        ["m_lam_metal", "面材", "金屬美耐板", "4x8尺", "髮絲銀", "張", "建材行C", 2500, "", "裝飾性強，收邊需注意"],
        ["m_edge_pvc", "面材", "PVC封邊條", "6分/8分", "同色", "捲", "建材行C", 300, "1捲100米", "木心板收邊用"],
        ["m_edge_abs", "面材", "ABS封邊條", "1.0mm厚", "同色", "捲", "建材行C", 600, "", "耐撞擊，質感較佳"],

        // --- F. 系統/櫃體五金 (System Hardware) ---
        ["m_hinge_110", "五金", "西德鉸鍊 (110度)", "六分/三分/入柱", "Blum緩衝", "顆", "五金行B", 120, "1箱250顆", "標準門片用，需確認蓋分"],
        ["m_hinge_165", "五金", "大角度鉸鍊 (165度)", "全蓋", "Blum", "顆", "五金行B", 250, "", "L型櫃轉角門，方便開啟"],
        ["m_hinge_pie", "五金", "折門鉸鍊 (Pie-cut)", "轉角", "Blum", "顆", "五金行B", 380, "", "L型轉角櫃連動門用"],
        ["m_hinge_blind", "五金", "盲角鉸鍊", "內建緩衝", "Blum", "顆", "五金行B", 180, "", "盲角櫃連接封板用"],
        ["m_slide_ball", "五金", "鋼珠滑軌 (三節)", "45cm (18寸)", "川湖", "組", "五金行B", 150, "1箱15組", "一般抽屜，側面安裝"],
        ["m_slide_under", "五金", "隱藏式滑軌 (緩衝)", "45cm", "川湖", "組", "五金行B", 650, "1箱10組", "美觀，抽牆需洗溝"],
        ["m_slide_push", "五金", "拍拍手滑軌 (反彈)", "45cm", "川湖", "組", "五金行B", 700, "1箱10組", "無把手設計用"],
        ["m_handle_alum", "五金", "鋁把手 (G型)", "3米長料", "霧黑", "支", "五金行B", 450, "", "需依門寬裁切"],
        ["m_handle_knob", "五金", "單孔把手 (圓鈕)", "直徑25mm", "黃銅", "顆", "五金行B", 120, "", "小抽屜或上櫃"],
        ["m_shelf_pin", "五金", "銅珠 (隔板粒)", "5mm", "鎳", "包", "五金行B", 100, "1包500顆", "活動層板用"],
        ["m_rod_hang", "五金", "吊衣桿 (鋁)", "圓管/蛋型", "霧銀", "尺", "五金行B", 80, "", "衣櫃內部"],
        ["m_rod_seat", "五金", "吊衣桿座 (目玉)", "隨桿型", "鋅合金", "個", "五金行B", 30, "", "固定吊衣桿"],

        // --- G. 螺絲與結合件 (Fasteners) ---
        ["m_screw_st64", "五金", "ST64 鋼釘", "64mm", "Box", "盒", "五金行B", 120, "", "大鋼牙氣槍用，打角材結構固定 (骨架),必須深入牆內 2.5cm 以上才安全。"],
        ["m_screw_st45", "五金", "ST45 鋼釘", "45mm", "Box", "盒", "五金行B", 100, "", "木芯板固定用,必須深入牆內 2.5cm 以上才安全。"],
        ["m_nail_f50", "五金", "F50 氣釘", "50mm", "Box", "盒", "五金行B", 80, "", "單針，木作結構"],
        ["m_nail_f30", "五金", "F30 氣釘", "30mm", "Box", "盒", "五金行B", 70, "", "單針，6mm板材固定"],
        ["m_nail_422", "五金", "422 雙腳釘", "22mm", "Box", "盒", "五金行B", 150, "", "ㄇ型釘，天花板骨架"],
        ["m_nail_j422", "五金", "J422 (不鏽鋼)", "22mm", "Box", "盒", "五金行B", 350, "", "ㄇ型釘，天花板面材封板用，防鏽"],
        ["m_nail_p30", "五金", "蚊釘 (P30)", "30mm", "Box", "盒", "五金行B", 90, "", "極細無頭，收邊壓條"],
        ["m_scr_chip_34", "五金", "木螺絲 (6分)", "#8 x 3/4\"", "鍍鋅", "包", "五金行B", 80, "1包500支", "鎖滑軌、鉸鍊底座"],
        ["m_scr_chip_1", "五金", "木螺絲 (1寸)", "#8 x 1\"", "黑鐵", "包", "五金行B", 90, "", "鎖兩分板"],
        ["m_scr_chip_12", "五金", "木螺絲 (1寸2)", "#8 x 1-1/4\"", "黑鐵", "包", "五金行B", 100, "", "鎖四分板"],
        ["m_scr_chip_15", "五金", "木螺絲 (1寸半)", "#8 x 1-1/2\"", "黑鐵", "包", "五金行B", 120, "", "鎖角材結構"],
        ["m_scr_chip_2", "五金", "木螺絲 (2寸)", "#8 x 2\"", "黑鐵", "包", "五金行B", 150, "", "加強固定"],
        ["m_scr_tap_1", "五金", "自攻螺絲 (1寸)", "每頭", "白鐵", "包", "五金行B", 200, "", "鎖C型鋼或薄鐵"],
        ["m_kd_cam", "五金", "KD結合器 (公母)", "三合一", "鋅合金", "包", "五金行B", 300, "1包100組", "系統櫃拆裝結構"],

        // --- H. 膠類與填縫 (Adhesives) ---
        ["m_glue_white", "膠類", "強力白膠 (樹脂)", "3kg", "南寶3761", "包", "建材行A", 150, "1箱6包", "木工通用，慢乾"],
        ["m_glue_yellow", "膠類", "強力膠", "3kg", "南寶105", "罐", "建材行A", 600, "", "貼皮、美耐板主力，易燃"],
        ["m_glue_spray", "膠類", "噴膠 (3M 77)", "745ml", "3M", "罐", "五金行B", 350, "", "大面積臨時固定，波浪板"],
        ["m_glue_ca", "膠類", "三秒膠 (長春)", "50g", "CA-260", "罐", "五金行B", 80, "小箱10罐", "修補、固定小飾條"],
        ["m_glue_acc", "膠類", "硬化劑 (加速)", "噴霧", "長春", "罐", "五金行B", 150, "", "搭配三秒膠使用"],
        ["m_sil_acid", "膠類", "酸性矽利康", "300ml", "道康寧", "支", "五金行B", 90, "1箱25支", "玻璃、鋁窗(除霉)"],
        ["m_sil_neut", "膠類", "中性矽利康", "300ml", "道康寧", "支", "五金行B", 85, "1箱25支", "一般材質、木作收邊"],
        ["m_sil_bio", "膠類", "防霉矽利康", "300ml", "Bio", "支", "五金行B", 150, "", "浴室廚房專用"],
        ["m_foam_pu", "膠類", "發泡劑 (PU Foam)", "500ml", "一般", "罐", "五金行B", 120, "", "填補大縫隙、門框塞縫"],
        ["m_ab_glue", "膠類", "AB膠 (立可健)", "一組", "一般", "組", "五金行B", 200, "", "石材、金屬強力黏合"],
        ["m_putty_wall", "塗料", "批土 (雙喜)", "5加侖", "白", "桶", "油漆行D", 450, "", "牆面整平"],
        ["m_putty_car", "塗料", "原子灰 (汽車補土)", "1kg", "蝴蝶", "罐", "油漆行D", 300, "", "高硬度補縫，不收縮"],

        // --- I. 保護與雜項 (Misc) ---
        ["m_protect_pp", "保護", "PP瓦楞板", "3x6尺", "半透明", "張", "建材行A", 25, "1捆20張", "地板第一層保護"],
        ["m_protect_ply", "保護", "保護夾板", "2分/3x6尺", "回收材", "張", "建材行A", 180, "", "地板第二層保護，防撞"],
        ["m_tape_pvc", "保護", "PVC 膠帶 (地球)", "48mm", "橘/綠", "捲", "五金行B", 25, "1條6捲", "黏貼保護板"],
        ["m_tape_mask", "保護", "紙膠帶 (和紙)", "24mm", "3M/日本製", "捲", "五金行B", 35, "1條5捲", "油漆分色、不殘膠"],
        ["m_tape_opp", "保護", "透明寬膠帶", "48mm", "一般", "捲", "五金行B", 20, "", "封箱"],
        ["m_bag_trash", "雜項", "米袋 (廢棄物)", "特大", "編織", "個", "建材行A", 5, "1捆50個", "裝打石廢料"],
        ["m_bag_clear", "雜項", "透明垃圾袋", "90L", "厚款", "包", "五金行B", 120, "", "輕質垃圾"],
        ["m_blade_util", "耗材", "美工刀片 (大)", "10片裝", "OLFA黑刃", "盒", "五金行B", 150, "", "銳利度高"],
        ["m_blade_saw", "耗材", "軍刀鋸片", "木工用", "Bosch", "片", "五金行B", 80, "", "拆除切割"],
        ["m_sand_100", "耗材", "砂紙 #100", "紅", "鷹牌", "張", "五金行B", 10, "1包100張", "粗磨"],
        ["m_sand_180", "耗材", "砂紙 #180", "紅", "鷹牌", "張", "五金行B", 10, "", "中磨"],
        ["m_sand_240", "耗材", "砂紙 #240", "白", "自黏圓盤", "張", "五金行B", 15, "", "打磨機用"],
        ["m_mask_gen", "雜項", "活性碳口罩", "50入", "拋棄式", "盒", "藥局", 150, "", "防異味"],
        ["m_pencil_carp", "雜項", "木工鉛筆", "扁芯", "紅/黑", "支", "五金行B", 10, "1打12支", "畫線"],
        ["m_gloves_cot", "雜項", "棉紗手套", "24兩", "加厚", "雙", "五金行B", 15, "1打12雙", "搬運保護"],
        ["m_gloves_rub", "雜項", "止滑手套", "M/L", "3M", "雙", "五金行B", 120, "", "精細組裝"],

        // --- J. 輕鋼架與天花板 (Light Steel Framework) ---
        ["m_ls_main_12", "輕鋼架", "主骨 (Main Runner)", "12尺", "亞鉛", "支", "建材行A", 120, "1捆20支", "明架/暗架主結構"],
        ["m_ls_cross_4", "輕鋼架", "副骨 (Cross Runner)", "4尺", "亞鉛", "支", "建材行A", 45, "", "連接主骨"],
        ["m_ls_cross_2", "輕鋼架", "副骨 (Cross Runner)", "2尺", "亞鉛", "支", "建材行A", 25, "", "連接主骨"],
        ["m_ls_angle", "輕鋼架", "收邊料 (L條)", "10尺", "烤漆白", "支", "建材行A", 60, "", "牆邊收尾"],
        ["m_ls_hanger", "輕鋼架", "吊筋 (全牙螺桿)", "3米/3分", "鍍鋅", "支", "五金行B", 50, "1捆50支", "懸吊結構"],
        ["m_ls_anchor", "輕鋼架", "內迫壁虎 (3分)", "3分", "鍍鋅", "顆", "五金行B", 3, "1盒200顆", "打入樓板固定"],
        ["m_ls_clip", "輕鋼架", "蝴蝶夾 (結合片)", "一般", "鍍鋅", "個", "五金行B", 5, "1包100個", "連接吊筋與主骨"],
        ["m_ls_ud_wall", "輕鋼架", "天地U型槽 (輕隔間)", "65型/3米", "鍍鋅", "支", "建材行A", 180, "", "輕隔間上下槽"],
        ["m_ls_c_stud", "輕鋼架", "立柱C型鋼 (輕隔間)", "65型/3米", "鍍鋅", "支", "建材行A", 200, "", "輕隔間立柱"],
        ["m_ls_rockwool", "輕鋼架", "岩棉 (吸音棉)", "60K/2吋", "一般", "包", "建材行A", 550, "1包6片", "隔音填充"],

        // --- K. 地板與塑膠地磚 (Flooring) ---
        ["m_fl_spc_oak", "地板", "SPC石塑地板", "4mm+1.5", "橡木紋", "坪", "地板商", 2200, "1箱0.6坪", "卡扣式，防水耐磨"],
        ["m_fl_pvc_sq", "地板", "塑膠地磚 (方塊)", "2.0mm", "石紋", "坪", "地板商", 900, "1箱1坪", "黏貼式，經濟"],
        ["m_fl_pvc_plank", "地板", "塑膠地磚 (長條)", "2.0mm", "木紋", "坪", "地板商", 1000, "1箱1坪", "黏貼式，仿木地板"],
        ["m_fl_eng_teak", "地板", "海島型木地板", "200條/4寸", "柚木", "坪", "地板商", 4500, "", "質感佳，需打底"],
        ["m_fl_underlay", "地板", "靜音墊 (IXPE)", "1.5mm", "黑", "捲", "地板商", 800, "1捲10坪", "鋪設於地板下"],
        ["m_fl_trans", "地板", "起步條/區隔條", "8尺", "鋁合金", "支", "地板商", 450, "", "異材質介面收邊"],
        ["m_fl_stair_n", "地板", "樓梯止滑條", "8尺", "PVC", "支", "地板商", 250, "", "樓梯鼻頭收邊"],

        // --- L. 玻璃與鏡面 (Glass) ---
        ["m_gl_clear_5", "玻璃", "清玻璃", "5mm", "强化", "才", "玻璃行", 45, "", "一般窗戶、隔板"],
        ["m_gl_clear_8", "玻璃", "清玻璃", "8mm", "强化", "才", "玻璃行", 75, "", "層板、桌面"],
        ["m_gl_clear_10", "玻璃", "清玻璃", "10mm", "强化", "才", "玻璃行", 110, "", "淋浴門、隔間"],
        ["m_gl_mir_clr", "玻璃", "明鏡", "5mm", "一般", "才", "玻璃行", 80, "", "一般鏡子"],
        ["m_gl_mir_gry", "玻璃", "灰鏡/黑鏡", "5mm", "一般", "才", "玻璃行", 120, "", "裝飾牆面"],
        ["m_gl_mir_brz", "玻璃", "茶鏡", "5mm", "一般", "才", "玻璃行", 120, "", "裝飾牆面"],
        ["m_gl_pain_w", "玻璃", "烤漆玻璃 (白)", "5mm", "强化", "才", "玻璃行", 180, "", "廚房防濺板、白板牆"],
        ["m_gl_long_w", "玻璃", "長虹玻璃 (直紋)", "5mm", "强化", "才", "玻璃行", 250, "", "屏風、門片，透光不透視"],
        ["m_gl_moru", "玻璃", "長虹玻璃 (小冰柱)", "5mm", "强化", "才", "玻璃行", 280, "", "復古風紋路"],
        ["m_gl_clip", "五金", "玻璃夾 (魚嘴夾)", "5-8mm", "鋅合金", "顆", "五金行B", 45, "", "固定層板"],
        ["m_gl_spid", "五金", "玻璃抓具 (四爪)", "大型", "不鏽鋼", "組", "五金行B", 1500, "", "帷幕牆或大型隔間"],

        // --- M. 水電材料基礎 (Basic MEP) ---
        ["m_el_pvc_w", "水電", "PVC電管 (E管)", "1/2\" (4分)", "南亞", "支", "水電行", 45, "1捆20支", "4米長，埋入或明管"],
        ["m_el_pvc_g", "水電", "PVC電管 (E管)", "3/4\" (6分)", "南亞", "支", "水電行", 65, "1捆10支", "幹線用"],
        ["m_el_box_1", "水電", "單聯接線盒", "鐵/深型", "一般", "個", "水電行", 15, "1盒100個", "開關插座底盒"],
        ["m_el_box_2", "水電", "雙聯接線盒", "鐵/深型", "一般", "個", "水電行", 25, "1盒50個", "四切開關或雙插座"],
        ["m_el_box_oct", "水電", "八角盒", "鐵", "一般", "個", "水電行", 20, "", "燈具出線盒"],
        ["m_el_cd_16", "水電", "CD管 (軟管)", "16mm", "白/黑", "捲", "水電行", 350, "1捲50米", "天花板佈線"],
        ["m_el_wire_2.0", "水電", "單芯線 (2.0mm)", "紅/白/黑/綠", "太平洋", "捲", "水電行", 1400, "1捲100米", "室內插座/照明"],
        ["m_el_wifi_5.5", "水電", "絞線 (5.5mm)", "3C", "太平洋", "捲", "水電行", 4500, "1捲100米", "專用迴路(冷氣/廚房)"],
        ["m_el_cable_cat6", "水電", "網路線 (CAT6)", "藍", "大同", "箱", "水電行", 3200, "1箱305米", "弱電網路"],
        ["m_pl_pvc_w4", "水電", "PVC水管 (W管)", "1/2\" (4分)", "南亞A", "支", "水電行", 55, "4米", "給水管"],
        ["m_pl_pvc_w6", "水電", "PVC水管 (W管)", "3/4\" (6分)", "南亞A", "支", "水電行", 80, "4米", "給水幹管"],
        ["m_pl_pvc_d2", "水電", "PVC排水管 (薄)", "2\"", "南亞B", "支", "水電行", 120, "4米", "一般排水"],
        ["m_pl_pvc_d4", "水電", "PVC排水管 (厚)", "4\"", "南亞A", "支", "水電行", 450, "4米", "糞管"],
        ["m_pl_f_el_90", "水電", "給水彎頭 (L)", "4分", "南亞", "個", "水電行", 8, "", "轉角"],
        ["m_pl_f_el_45", "水電", "給水45度", "4分", "南亞", "個", "水電行", 10, "", "閃管用"],
        ["m_pl_f_tee", "水電", "給水三通 (T)", "4分", "南亞", "個", "水電行", 12, "", "分歧"],
        ["m_pl_f_sock", "水電", "給水接頭 (S)", "4分", "南亞", "個", "水電行", 6, "", "續接"],
        ["m_pl_f_ws", "水電", "龍口彎 (內牙)", "4分", "銅牙", "個", "水電行", 45, "", "水龍頭出口，需固定"],

        // --- N. 照明燈具 (Lighting) ---
        ["m_li_down_9", "燈具", "崁燈 (9.5cm)", "10W/3000K", "Philips", "盞", "燈飾店", 180, "", "一般天花板照明"],
        ["m_li_down_15", "燈具", "崁燈 (15cm)", "15W/4000K", "Philips", "盞", "燈飾店", 250, "", "商空或高挑照明"],
        ["m_li_box_ar111", "燈具", "盒燈 (AR111)", "雙聯/黑框", "LED 12W", "組", "燈飾店", 1200, "", "重點投射照明"],
        ["m_li_t5_4", "燈具", "T5 層板燈", "4尺/20W", "串接型", "支", "燈飾店", 250, "", "間接照明"],
        ["m_li_t5_2", "燈具", "T5 層板燈", "2尺/10W", "串接型", "支", "燈飾店", 200, "", "間接照明"],
        ["m_li_strip", "燈具", "LED 軟條燈", "10W/米", "3000K 24V", "捲", "燈飾店", 850, "1捲5米", "需配變壓器，線性光"],
        ["m_li_driver", "燈具", "變壓器 (明緯)", "24V/150W", "防潑水", "台", "燈飾店", 950, "", "驅動軟條燈用"],
        ["m_li_track", "燈具", "軌道條", "2米", "黑/白", "支", "燈飾店", 350, "", "軌道燈用"],
        ["m_li_tk_spot", "燈具", "軌道燈 (投射)", "12W", "黑/白", "盞", "燈飾店", 450, "", "投射畫作或牆面"],

        // --- O. 開關插座 (Switch & Socket) ---
        ["m_sw_1", "開關", "單切開關 (大板)", "Panasonic", "星光", "組", "水電行", 250, "", "含蓋板"],
        ["m_sw_2", "開關", "雙切開關 (大板)", "Panasonic", "星光", "組", "水電行", 380, "", "含蓋板"],
        ["m_sw_3", "開關", "三切開關 (大板)", "Panasonic", "星光", "組", "水電行", 520, "", "含蓋板"],
        ["m_sock_w", "開關", "雙孔插座 (附地)", "Panasonic", "星光", "組", "水電行", 280, "", "一般電源"],
        ["m_sock_r", "開關", "專用插座 (紅)", "220V/T型", "Panasonic", "組", "水電行", 350, "", "冷氣或烤箱專用"],
        ["m_sock_tv", "開關", "電視插座", "F型接頭", "星光", "組", "水電行", 300, "", "第四台訊號"],
        ["m_sock_net", "開關", "網路插座 (CAT6)", "RJ45", "星光", "組", "水電行", 450, "", "網路訊號"],
        ["m_plate_blk", "開關", "鋁拉絲蓋板", "Panasonic", "Glacier", "片", "水電行", 800, "", "高級系列，僅蓋板"],

        // --- P. 窗簾與飾軟 (Curtains) ---
        ["m_cur_rl_s", "窗簾", "遮光捲簾", "素色", "一般", "才", "窗簾店", 120, "", "經濟實惠"],
        ["m_cur_wood", "窗簾", "木百葉窗", "50mm葉片", "一般", "才", "窗簾店", 350, "", "調光性佳，質感好"],
        ["m_cur_comb", "窗簾", "蜂巢簾 (風琴簾)", "全遮光", "一般", "才", "窗簾店", 450, "", "隔熱效果佳"],
        ["m_cur_track", "窗簾", "蛇型簾軌道", "鋁合金", "手拉", "尺", "窗簾店", 250, "", "蛇型簾專用"],

        // --- Q. 其他五金雜項 (More Hardware) ---
        ["m_lock_cyl", "五金", "水平鎖 (房間)", "60mm", "不鏽鋼", "組", "五金行B", 450, "", "一般房門"],
        ["m_lock_bath", "五金", "浴廁鎖 (無鑰匙)", "60mm", "不鏽鋼", "組", "五金行B", 400, "", "可用硬幣開啟"],
        ["m_door_stpr", "五金", "門擋 (磁吸)", "地裝/牆裝", "不鏽鋼", "個", "五金行B", 150, "", "防止撞牆"],
        ["m_shelf_sup", "五金", "層板托架 (L型)", "20cm", "鐵/烤漆", "支", "五金行B", 80, "", "固定牆上層板"],
        ["m_hook_coat", "五金", "掛衣勾", "單勾", "黑鐵", "個", "五金行B", 60, "", "玄關衣帽"],
        ["m_air_vent", "五金", "通氣網 (鋁)", "長型", "銀/黑", "個", "五金行B", 120, "", "鞋櫃透氣用"],
        ["m_wire_mgt", "五金", "出線孔蓋", "60mm", "塑料/鋁", "個", "五金行B", 50, "", "書桌穿線"],
        ["m_caster_brk", "五金", "活動輪 (附煞)", "2寸", "PU輪", "顆", "五金行B", 80, "", "活動櫃用"],
        ["m_caster_fix", "五金", "固定輪", "2寸", "PU輪", "顆", "五金行B", 60, "", "活動櫃用"],
        ["m_adj_foot", "五金", "調整腳 (櫥櫃)", "10cm", "塑料", "支", "五金行B", 40, "", "廚具櫃體調整"],
        ["m_hang_rod_fl", "五金", "法蘭片 (管頭)", "1寸", "鐵鍍鋅", "個", "五金行B", 35, "", "工業風水管架用"]
    ];
    writeToSheet(ss, "DB_Materials", materials);

    // ==========================================
    // 2. DB_Tools (100項：維修工具)
    // ==========================================
    const tools = [
        ["t_comp_2hp", "電動", "2HP空壓機 (雙缸)", "110V", "Site", "倉庫", "每日放水，每週檢查機油", "電壓需穩定，避免使用過長延長線降壓"],
        ["t_comp_quiet", "電動", "靜音空壓機", "110V", "Site", "倉庫", "定期清潔濾棉", "適合夜間或安靜案場"],
        ["t_saw_table", "電動", "桌上型圓鋸機 (Sawstop)", "110V", "Site", "倉庫", "清除鋸屑，檢查煞車匣", "切割板材必備，需配集塵"],
        ["t_saw_miter", "電動", "角度切斷機 (Slide)", "110V", "Site", "倉庫", "校正垂直/45度角", "裁切角材、線板用"],
        ["t_nail_f50", "氣動", "F50 單針釘槍", "Air", "Site", "工具箱A", "每日滴油2-3滴", "結構用，注意釘長選擇"],
        ["t_nail_f30", "氣動", "F30 單針釘槍", "Air", "Site", "工具箱A", "每日滴油", "固定薄板用"],
        ["t_nail_422", "氣動", "422 雙腳釘槍", "Air", "Site", "工具箱A", "每日滴油，檢查撞針", "天花板骨架專用，抓力強"],
        ["t_nail_st64", "氣動", "ST64 大鋼牙", "Air", "Site", "工具箱A", "每日滴油，槍口清理", "打混凝土牆專用"],
        ["t_nail_p22", "氣動", "蚊釘槍 (P22)", "Air", "Site", "工具箱A", "精密撞針易斷，小心輕放", "表面收邊用，幾乎無痕"],
        ["t_drill_imp", "電動", "18V 衝擊起子機", "18V", "Worker", "隨身", "電池觸點清潔，定期吹塵", "鎖螺絲主力，扭力大"],
        ["t_drill_driver", "電動", "12V 電鑽/起子", "12V", "Worker", "隨身", "夾頭上油", "鑽孔、組裝櫃體用(扭力可調)"],
        ["t_hammer_rot", "電動", "免出力錘鑽 (三用)", "18V", "Site", "倉庫", "夾頭清潔，鑽尾上油", "鑽牆、打壁虎用"],
        ["t_router_fixed", "電動", "修邊機 (6mm)", "110V", "Worker", "隨身", "碳刷檢查，底座滑順度", "修皮、導角用，注意轉速高"],
        ["t_router_plunge", "電動", "路達 (12mm)", "110V", "Site", "倉庫", "升降柱上油", "開溝、挖孔用"],
        ["t_planer_elec", "電動", "手提電柏機", "110V", "Site", "倉庫", "刀片利度檢查", "修整門片邊緣"],
        ["t_jigsaw", "電動", "線鋸機", "18V", "Site", "倉庫", "底板防刮墊片檢查", "曲線切割，挖開關盒孔"],
        ["t_multi_tool", "電動", "磨切機 (魔切)", "18V", "Site", "倉庫", "更換刀片需鎖緊", "死角切割、切鐵釘神器"],
        ["t_sander_orb", "電動", "偏心砂磨機", "110V", "Site", "倉庫", "集塵袋清理", "大面積打磨，避免繞圈痕"],
        ["t_sander_belt", "電動", "戰車 (砂帶機)", "110V", "Site", "倉庫", "滾輪積碳清除", "粗磨整平用"],
        ["t_collated_scr", "電動", "連發螺絲槍", "110V", "Site", "倉庫", "槍頭深度調整", "封矽酸鈣板神器，速度快"],
        ["t_laser_green", "測量", "綠光雷射水平儀 (5線)", "Battery", "Site", "防潮箱", "每年校正，電池取出", "室內放樣必備"],
        ["t_laser_floor", "測量", "貼地雷射儀", "Battery", "Site", "防潮箱", "鏡面防刮", "地板工程專用"],
        ["t_dist_meter", "測量", "雷射測距儀", "Battery", "Worker", "隨身", "避免摔落", "快速量房"],
        ["t_level_60", "測量", "水平尺 (60cm)", "None", "Worker", "隨身", "保持底面清潔", "安裝門框、櫃體檢查"],
        ["t_tape_5m", "測量", "魯班尺 (5.5m/25mm)", "None", "Worker", "隨身", "尺帶防鏽", "文公字需清晰"],
        ["t_angle_ruler", "測量", "不鏽鋼角尺", "None", "Worker", "隨身", "防彎折", "90度確認"],
        ["t_ink_marker", "測量", "墨斗 (自動捲回)", "None", "Worker", "隨身", "海綿保濕，墨線更換", "彈線放樣"],
        ["t_stud_finder", "測量", "牆體探測儀", "9V", "Site", "儀器盒", "電池取出", "偵測水管電線"],
        ["t_hammer_claw", "手工具", "羊角鎚", "None", "Worker", "隨身", "手柄防滑檢查", "敲擊、拔釘"],
        ["t_mallet_rub", "手工具", "橡膠鎚", "None", "Worker", "隨身", "表面清潔", "組裝櫃體、敲地板"],
        ["t_chisel_set", "手工具", "木工鑿刀組", "None", "Worker", "刀袋", "定期研磨刀鋒", "修整榫頭、安裝鉸鍊"],
        ["t_plane_hand", "手工具", "手推刨 (角利)", "None", "Worker", "隨身", "刀片防鏽", "細微修邊"],
        ["t_saw_hand", "手工具", "雙面手鋸 (日式)", "None", "Worker", "隨身", "鋸齒防鏽", "精密切割，免插電"],
        ["t_saw_flush", "手工具", "埋木鋸 (平切鋸)", "None", "Worker", "隨身", "防折損", "切除凸出的木塞"],
        ["t_clamp_f", "手工具", "F夾 (30cm)", "None", "Site", "倉庫", "螺桿上油", "固定板材"],
        ["t_clamp_quick", "手工具", "快速夾 (單手)", "None", "Site", "倉庫", "檢查夾力", "快速固定"],
        ["t_pry_bar", "手工具", "拔釘器 (肉魯仔)", "None", "Worker", "隨身", "", "拆除用"],
        ["t_cat_paw", "手工具", "貓爪起釘器", "None", "Worker", "隨身", "", "精細拔釘"],
        ["t_utility_knife", "手工具", "美工刀 (大)", "None", "Worker", "隨身", "刀片隨時更換", "通用切割"],
        ["t_putty_knife", "手工具", "補土刀 (非碳鋼)", "None", "Worker", "隨身", "使用後擦乾", "補AB膠、批土"],
        ["t_caulk_gun", "手工具", "矽利康槍", "None", "Worker", "隨身", "推桿清潔", "打膠用"],
        ["t_caulk_scra", "手工具", "刮膠刀 (抹刀)", "None", "Worker", "隨身", "殘膠清除", "矽利康修飾"],
        ["t_demo_hammer", "電動", "破碎機 (鴨頭)", "110V", "Site", "倉庫", "定期加黃油", "拆除牆面、地磚"],
        ["t_mixer_mud", "電動", "攪拌機", "110V", "Site", "倉庫", "攪拌棒水泥清除", "攪拌水泥砂漿、彈泥"],
        ["t_tile_cutter", "手工具", "手動切磚機", "None", "Site", "倉庫", "滑軌上油，刀輪檢查", "直線切割磁磚"],
        ["t_grinder_4", "電動", "4吋平面砂輪機", "110V", "Site", "倉庫", "護蓋必須安裝", "切鐵、切石材"],
        ["t_trowel_not", "手工具", "鋸齒抹刀", "None", "Site", "工具箱B", "防鏽", "塗抹磁磚黏著劑"],
        ["t_tile_suc", "手工具", "磁磚吸盤", "None", "Site", "工具箱B", "橡膠面清潔", "搬運大板磚"],
        ["t_tile_level", "耗材", "磁磚整平器(底座)", "None", "Dynamic", "耗材區", "一次性", "保持磁磚平整"],
        ["t_tile_wedge", "耗材", "磁磚整平楔子", "None", "Site", "回收桶", "可重複使用", "搭配底座使用"],
        ["t_spray_airless", "電動", "無氣噴漆機", "110V", "Site", "倉庫", "使用後徹底循環清洗", "大面積噴塗，速度快"],
        ["t_roller_9", "耗材", "9吋滾筒刷", "None", "Dynamic", "耗材區", "使用後清洗或拋棄", "大面積刷塗"],
        ["t_brush_2", "耗材", "2吋毛刷", "None", "Dynamic", "耗材區", "刷毛順直", "收邊、小面積"],
        ["t_pole_ext", "手工具", "伸縮桿", "None", "Site", "倉庫", "鎖定機構檢查", "高處滾塗"],
        ["t_bucket_pt", "手工具", "調漆桶", "None", "Site", "倉庫", "殘漆清除", "調色用"],
        ["t_masking_tape", "耗材", "養生膠帶 (550/1100)", "None", "Dynamic", "耗材區", "一次性", "遮蔽傢俱"],
        ["t_sand_pole", "手工具", "長柄研磨板", "None", "Site", "倉庫", "魔鬼氈檢查", "天花板打磨"],
        ["t_pipe_cut_pvc", "手工具", "PVC管切刀", "None", "Site", "工具箱C", "刀片無缺角", "切斷水管"],
        ["t_pipe_press", "電動", "壓接機", "18V", "Site", "保險箱", "模具清潔防鏽", "不鏽鋼管壓接"],
        ["t_wire_strip", "手工具", "剝線鉗", "None", "Worker", "隨身", "刀口利度", "剝除電線皮"],
        ["t_fish_tape", "手工具", "拉線器 (引線)", "None", "Site", "倉庫", "避免死折", "穿管佈線"],
        ["t_multi_meter", "測量", "三用電錶", "9V", "Worker", "隨身", "探針檢查", "測量電壓、導通"],
        ["t_heat_gun", "電動", "熱風槍", "110V", "Site", "工具箱C", "進風口勿堵塞", "熱縮套管、烘烤"],
        ["t_wren_adj", "手工具", "活動扳手 (大/小)", "None", "Worker", "隨身", "螺桿上油", "鎖水管、龍頭"],
        ["t_wren_pipe", "手工具", "管子鉗", "None", "Site", "工具箱C", "咬合齒清潔", "鎖鍍鋅管"],
        ["t_ladder_a", "設施", "A字梯 (6尺)", "None", "Site", "陽台", "止滑腳墊檢查", "登高作業"],
        ["t_ladder_adj", "設施", "關節梯 (可調)", "None", "Site", "陽台", "關節鎖定確認", "樓梯間作業"],
        ["t_work_light", "設施", "LED工作燈 (腳架)", "110V", "Site", "倉庫", "收線整齊", "陰暗處照明"],
        ["t_ext_cord", "設施", "動力延長線 (動力輪)", "110V", "Site", "倉庫", "破皮檢查，過載保護", "供電"],
        ["t_fan_ind", "設施", "工業扇", "110V", "Site", "倉庫", "葉片清潔", "通風、加速乾燥"],
        ["t_vac_wetdry", "電動", "乾濕兩用吸塵器", "110V", "Site", "倉庫", "濾網敲塵，倒水", "工地清潔"],
        ["t_broom", "手工具", "掃把畚斗", "None", "Site", "陽台", "", "粗清"],
        ["t_trash_bag", "耗材", "米袋/太空袋", "None", "Dynamic", "耗材區", "", "清運廢料"],
        ["t_helmet", "個護", "工程帽", "None", "Worker", "個人", "帽襯清潔", "進場必備"],
        ["t_goggle", "個護", "護目鏡", "None", "Worker", "個人", "防刮", "打磨、切割必備"],
        ["t_mask_n95", "個護", "防塵口罩", "None", "Worker", "個人", "更換濾棉", "防粉塵"],
        ["t_moist_meter", "測量", "含水率測試儀", "9V", "Site", "儀器盒", "探針保護", "檢測牆面/木材濕度"],
        ["t_thermal_cam", "測量", "熱顯像儀", "Battery", "Site", "保險箱", "鏡頭保護", "抓漏水、電箱過熱"],
        ["t_wall_chas", "電動", "開槽機 (雙片)", "110V", "Site", "倉庫", "集塵管暢通", "水電埋管開槽"],
        ["t_detect_gas", "測量", "瓦斯偵測器", "Battery", "Site", "儀器盒", "感應頭清潔", "瓦斯管線測漏"],
        ["t_glass_suc", "手工具", "玻璃吸盤 (三爪)", "None", "Site", "工具箱D", "橡膠老化檢查", "安裝淋浴門"],
        ["t_scaffold", "設施", "施工架 (鷹架)", "None", "Site", "陽台", "插銷確認", "挑高作業"],
        ["t_cart_flat", "設施", "平板車 (烏龜車)", "None", "Site", "門口", "輪子轉動順暢", "搬運料"],
        ["t_dolly_2wh", "設施", "兩輪手推車 (老虎車)", "None", "Site", "門口", "輪胎氣壓", "搬運重物/桶裝料"],
        ["t_bucket_mix", "手工具", "攪拌桶 (黑)", "None", "Site", "陽台", "硬化水泥敲除", "泥作攪拌用"],
        ["t_scraper_fl", "手工具", "地坪刮刀 (長柄)", "None", "Site", "陽台", "刀片更換", "剷除地板殘膠"],
        ["t_shim_plast", "耗材", "塑膠墊片 (調整片)", "None", "Dynamic", "耗材區", "", "調整櫃體水平"],
        ["t_screw_mix", "耗材", "螺絲總匯盒", "None", "Site", "工具箱A", "分類補充", "各式常用螺絲"],
        ["t_anchor_plas", "耗材", "塑膠壁虎 (6mm)", "None", "Dynamic", "耗材區", "", "掛畫、掛件"],
        ["t_bit_set", "耗材", "起子頭組 (PH2)", "None", "Worker", "隨身", "磨損更換", "最常用十字頭"],
        ["t_drill_bit_til", "耗材", "磁磚鑽頭", "None", "Dynamic", "工具箱B", "退火更換", "浴室鑽孔勿開震動"],
        ["t_hole_saw", "耗材", "圓穴鋸組", "None", "Site", "倉庫", "鋸齒清除", "開燈孔 (15cm/9cm)"],
        ["t_jig_pocket", "手工具", "斜孔治具 (Kreg)", "None", "Site", "工具箱A", "鑽套檢查", "櫃體快速組裝"],
        ["t_lamello", "電動", "檸檬片機 (餅乾機)", "110V", "Site", "倉庫", "刀片檢查", "板材拼接"],
        ["t_domino", "電動", "木榫機 (Domino)", "110V", "Site", "保險箱", "極昂貴小心借用", "高級傢俱結構拼接"],
        ["t_vac_pump", "電動", "真空幫浦", "110V", "Site", "倉庫", "真空油更換", "冷氣抽真空"],
        ["t_mani_gauge", "測量", "冷媒雙錶", "None", "Site", "倉庫", "管線無破損", "冷氣壓力測試"],
        ["t_pipe_bend", "手工具", "彎管器", "None", "Site", "工具箱C", "適配管徑", "銅管/白鐵管彎曲"],
        ["t_sil_remov", "手工具", "矽利康刮除刀", "None", "Worker", "隨身", "利度檢查", "除霉重打膠"],
        ["t_grout_bag", "手工具", "擠花袋 (填縫袋)", "None", "Site", "工具箱B", "洗淨晾乾", "磁磚/石材填縫"],
        ["t_sponge_lg", "手工具", "海綿 (大)", "None", "Worker", "隨身", "洗淨", "泥作清潔/填縫擦拭"],
        ["t_tile_cip", "手工具", "磁磚倒角器", "None", "Site", "工具箱B", "45度角確認", "陽角加工"]
    ];
    writeToSheet(ss, "DB_Tools", tools);



    // ==========================================
    // 3. DB_Tasks (擴充：木作工程與常用項目)
    // ==========================================
    const tasks = [
        // --- 保護工程 ---
        ["protect_floor_2", "保護", "01_保護", "地板保護 (雙層:瓦楞+夾板)", "坪", 500,
            "1.清潔地面：撤除雜物並掃地清潔，避免砂粒刮傷地磚。\n2.鋪設防潮布(選用)：若地氣重可先鋪一層。\n3.第一層瓦楞板：全面鋪設PP瓦楞板，接縫處以寬膠帶黏貼固定。\n4.第二層夾板：在此之上鋪設1~2分夾板，緩衝撞擊力。\n5.固定與收邊：四周及接縫處使用養生膠帶或PVC膠帶固定，確保不滑動。",
            "1.重疊平整：保護層接縫處需重疊並密合，無裸露地面。\n2.穩固不滑動：踩踏時保護層不應滑動。\n3.轉角包覆：牆角、門框根部應有加強包覆。\n4.殘膠檢查：膠帶應使用不殘膠材質(如養生膠帶)。",
            "三層保護標準：防潮布+瓦楞板+夾板"],

        ["protect_floor_1", "保護", "01_保護", "地板保護 (單層:瓦楞)", "坪", 300,
            "1.清潔地面：確保無尖銳砂石。\n2.鋪設瓦楞板：全面覆蓋地坪。\n3.膠帶固定：接縫處以膠帶黏貼。",
            "1.覆蓋完整：確認無地磚裸露。\n2.固定確實：行走時不翻起。",
            "無"],

        ["protect_elev", "保護", "01_保護", "電梯/公設保護", "式", 3000,
            "1.測量尺寸：確認電梯門、長寬高及按鈕位置。\n2.角材骨架：視管委會規範，可能需先釘木骨架。\n3.封板保護：使用PP板或夾板包覆電梯壁面及地板。\n4.開孔：按鈕面板、扶手處精準開孔。\n5.動線保護：大廳至電梯動線鋪設保護材。",
            "1.不影響功能：電梯開關門順暢，按鈕好按。\n2.無死角：牆角、地板角落皆有覆蓋。\n3.外觀整潔：保護材外觀乾淨，無破損髒污。\n4.管委會驗收：需符合大樓管委會要求。",
            "含電梯內部與梯廳動線"],

        // --- 天花板工程 ---
        ["ceil_flat_lv", "木作", "03_天花", "平釘天花板 (矽酸鈣)", "坪", 3200,
            "1.雷射放樣：確認全室水平高度(H)。\n2.固定角材：四周釘邊材，中間下利用角材(間距30-40cm)，並使用吊筋(間距90cm)固定於樓板。\n3.管線查驗：確認燈具、空調、消防出線位置正確。\n4.封板：使用矽酸鈣板，白膠+雙腳釘固定，板與板間留3-5mm伸縮縫。\n5.開孔：依圖面開設燈孔、維修孔、出風口。",
            "1.水平平整：目視無波浪，雷射儀檢測誤差<3mm。\n2.結構穩固：推擠無異音，吊筋密度足夠。\n3.接縫處理：伸縮縫填補平整，無龜裂。\n4.開孔正確：維修孔位置合理，且邊框有補強。\n5.淨高確認：完成面高度符合設計。",
            "矽酸鈣板6mm (日本/台灣)"],

        ["ceil_ind_lv", "木作", "03_天花", "間接照明天花板", "尺", 450,
            "1.骨架製作：依設計斷面圖製作燈槽骨架。\n2.立板封板：釘設垂直與水平封板。\n3.燈具試裝：確認T5燈管放置空間足夠(通常深12-15cm)。\n4.表面修飾：確保出光口邊緣平直。",
            "1.光線均勻：燈管重疊無暗帶。\n2.線條筆直：燈槽邊緣無彎曲。\n3.無溢光：燈管隱藏良好，直視不可見燈管。",
            "無"],

        ["ceil_pvc_bath", "木作", "03_天花", "浴室PVC天花板", "坪", 3500,
            "1.防腐角材：使用PVC角材或防腐木角材。\n2.水平放樣：確認高度。\n3.鋪設PVC板：長條型企口板拼接。\n4.收邊：四周使用專用收邊條或矽利康。\n5.維修孔：預留維修孔於維修閥或管道間下方。",
            "1.防水密合：板材接縫密合，矽利康打膠完整。\n2.維修便利：維修孔可順利開啟。\n3.表面清潔：無指紋污漬。",
            "南亞或其他PVC板"],

        ["ceil_curtain", "木作", "03_天花", "窗簾盒 (木作)", "尺", 350,
            "1.確認尺寸：單軌(15cm)/雙軌(25cm)/電動(30cm)。\n2.骨架加強：窗簾軌道鎖附位置需有木芯板補強。\n3.封板：配合天花板整體封板。",
            "1.承重結構：手壓軌道鎖點不凹陷。\n2.寬度足夠：窗簾布收納不卡住。\n3.直線性：長距離需筆直。",
            "無"],

        // --- 隔間與牆面 ---
        ["wall_1s_ply", "木作", "04_牆面", "單面隔間 (夾板)", "尺", 900,
            "1.放樣：彈出牆位線。\n2.立柱：使用角材立柱，間距30-40cm，並設橫撐。\n3.封板：單面封夾板(通常為背面或貼牆面)。\n4.補強：掛重物處(如電視)需多加木芯板或角材。",
            "1.垂直度：牆面垂直無傾斜。\n2.結構：按壓無異音。\n3.平面度：板材接縫平整。",
            "無"],

        ["wall_2s_sil", "木作", "04_牆面", "雙面隔間 (矽酸鈣+隔音)", "尺", 1400,
            "1.骨架：立角材骨架(間距30cm)。\n2.水電配管：預埋開關箱、管路。\n3.單面封板：先封一面矽酸鈣板。\n4.填充：填入岩棉或隔音棉(60K/24K)。\n5.雙面封板：封另一面矽酸鈣板。",
            "1.隔音效果：敲擊聲結實不空洞。\n2.垂直平整：雙面皆需平整。\n3.管路：確認插座位置正確，無短路。",
            "含60K岩棉"],

        ["wall_feat_ven", "木作", "04_牆面", "造型牆 (實木皮)", "尺", 2200,
            "1.底板整平：釘6mm或9mm夾板打底。\n2.貼皮：選定實木皮，背面塗強力膠，待半乾後貼合。\n3.熨燙：使用熨斗熱壓確保貼合緊密。\n4.保護漆：上底漆+面漆保護。",
            "1.對花紋路：木紋銜接自然美觀。\n2.無氣泡：表面平整無凸起。\n3.邊角密合：轉角處無脫膠翹起。",
            "塗裝板或現場貼皮"],

        ["wall_feat_lam", "木作", "04_牆面", "造型牆 (美耐板)", "尺", 1800,
            "1.底板：木芯板或夾板打底，表面需極度平整。\n2.上膠：強力膠均勻塗佈於板材與美耐板背面。\n3.貼合：使用滾輪或木塊加壓推平。\n4.修邊：使用修邊機修整邊緣導角。",
            "1.接縫細緻：黑線(芯材)不明顯。\n2.表面無波浪：光影反射下無波紋。\n3.無溢膠：表面乾淨無殘膠。",
            "富美家或其他品牌"],

        // --- 地板工程 ---
        ["floor_raise_st", "木作", "02_地板", "架高地板 (結構)", "坪", 4500,
            "1.防潮：鋪設防潮布。\n2.角材網格：依高度需求釘設角材(間距30-40cm)。\n3.補強：中空處可補立柱或高密度保麗龍。\n4.底板：釘設6分夾板，留伸縮縫。\n5.面材：上方再鋪木地板。",
            "1.踩踏無聲：行走無ㄍㄧ乖聲。\n2.水平：整體水平誤差<3mm。\n3.穩固：重踩無下陷感。",
            "夾板F3以上"],

        ["floor_spc", "地板", "02_地板", "SPC石塑地板 (直鋪)", "坪", 2500,
            "1.素地整理：地面高低差<3mm/2m，剷除凸起物。\n2.防潮靜音：鋪設IXPE靜音墊(通常已附在板底)。\n3.起鋪：從牆角開始，卡扣拼接。\n4.伸縮縫：四周牆邊留8-10mm伸縮縫(防熱脹冷縮)。\n5.收邊：使用矽利康或踢腳板收邊。",
            "1.接縫密合：卡扣處無縫隙、無翹角。\n2.伸縮縫：牆邊確實留縫，未被矽利康填死。\n3.無異音：踩踏無空心聲或斷裂聲。\n4.收邊美觀：門檻、轉角收邊平整。",
            "4mm+1.5mm以上"],

        ["floor_eng", "地板", "02_地板", "海島型木地板 (平鋪)", "坪", 5500,
            "1.防潮布：鋪設防潮布(厚0.05mm以上)。\n2.底板：釘4分夾板於地面(平鋪法)。\n3.鋪設：使用地板專用膠+蚊釘(45度角)固定木地板。\n4.保護：完工後立即鋪設保護板。",
            "1.表面無傷：無刮痕撞傷。\n2.行走紮實：無浮動感。\n3.色澤均勻：無明顯色差(自然木紋除外)。",
            "天然木皮表面"],

        // --- 櫃體工程 (System & Woodwork) ---
        ["cab_ward_sys", "系統", "05_櫃體", "系統衣櫃 (高240)", "尺", 5500,
            "1.進料檢查：確認板材尺寸、孔位、五金數量。\n2.組裝桶身：KD結合器組裝櫃體。\n3.定位水平：調整腳調整水平，並加上墊片。\n4.固定牆面：櫃體間對鎖，並鎖附於牆面防傾倒。\n5.安裝門片/內裝：裝上鉸鍊、滑軌、拉籃。\n6.收邊：施作封板與矽利康。",
            "1.穩固不搖：櫃體固定牢靠。\n2.門縫調整：門片間隙均勻(約2mm)，上下齊平。\n3.五金順暢：抽屜滑動順暢，緩衝功能正常。\n4.無破口：管線穿孔處有修飾蓋。",
            "V313 E1/E0板材"],

        ["cab_shoe_sys", "系統", "05_櫃體", "系統鞋櫃 (高100)", "尺", 3200,
            "1.組裝桶身：同衣櫃。\n2.背板透氣：鞋櫃背板或側板需裝透氣孔。\n3.懸空固定：若為懸空式，需使用膨脹螺絲加強牆面固定力。",
            "1.承重測試：懸空櫃體重壓無變形。\n2.透氣設計：確認有透氣孔。\n3.層板活動：活動層板銅珠安裝正確。",
            "無"],

        ["cab_tv_wood", "木作", "05_櫃體", "木作電視櫃 (懸空)", "尺", 4200,
            "1.骨架與桶身：木芯板製作桶身。\n2.加強背板：懸空處牆面需有補強結構。\n3.貼皮：表面貼實木皮或美耐板。\n4.五金安裝：安裝抽屜滑軌。\n5.線槽：預留電視、設備線路通道。",
            "1.懸空強度：承重無下垂。\n2.貼皮細節：轉角對花，無脫膠。\n3.走線便利：所有設備線路可通且不雜亂。",
            "無"],

        ["cab_kitch_u", "廚具", "05_櫃體", "廚具上櫃", "cm", 120,
            "1.掛軌安裝：水平線放樣，固定吊掛片。\n2.掛櫃：將櫃體掛上並調整水平。\n3.連結：櫃體間螺絲對鎖。\n4.門片調整：調整鉸鍊。",
            "1.水平牢固：無傾斜風險。\n2.與天花縫隙：封板密合。",
            "無"],

        ["cab_kitch_l", "廚具", "05_櫃體", "廚具下櫃 (不含三機)", "cm", 180,
            "1.調整腳：調整檯面水平高度。\n2.檯面安裝：人造石/不鏽鋼檯面接合。\n3.水槽安裝：下崁或上崁，確實打膠防水。\n4.踢腳板：安裝防水踢腳板。",
            "1.檯面接縫：人造石接縫需無痕、平滑。\n2.防水測試：水槽蓄水不漏，排水順暢。\n3.門片對齊：抽屜與門片線條整齊。",
            "無"],

        // --- 門窗與開口 ---
        ["door_room_set", "木作", "06_門窗", "房間門組 (便品)", "組", 6500,
            "1.立框：確認垂直水平(雷射儀)，使用固定片或螺絲固定門框。\n2.填縫：門框與牆面縫隙填入發泡劑或水泥砂漿(需確實)。\n3.裝門：安裝鉸鍊(3顆)與門片。\n4.安裝鎖具/門擋。\n5.收邊：安裝門框線板。",
            "1.開關順暢：不自動回彈或關不緊。\n2.縫隙均勻：門縫約3-5mm。\n3.隔音氣密：關門後氣密條有密合。\n4.外觀無傷：門扇無撞傷。",
            "便品門組型錄"],

        ["door_barn", "木作", "06_門窗", "穀倉門 (滑門)", "組", 8500,
            "1.軌道補強：牆面軌道鎖點需有木作骨架或實牆。\n2.安裝軌道：水平需精準。\n3.門片安裝：安裝滑輪與門片。\n4.止擺器：地板安裝止擺器(土牛)防止搖晃。\n5.防脫軌：安裝防脫軌擋片。",
            "1.滑動平順：無異音、不卡頓。\n2.安全性：用力推拉不會脫軌。\n3.止擺有效：門片下方不晃動。",
            "無"],

        ["pocket_door", "木作", "06_門窗", "隱藏門 (暗門)", "組", 12000,
            "1.特殊鉸鍊：安裝回歸鉸鍊(蝴蝶後紐)。\n2.門縫設計：精算門縫與貼皮厚度。\n3.表面延伸：門片材質需與牆面連續。\n4.自動回歸：調整鉸鍊力道。",
            "1.隱形效果：關門後縫隙極小，與牆面齊平。\n2.自動關閉：測試回歸功能是否正常。\n3.無把手：推門處不易髒污(可選耐髒材質)。",
            "無"],

        // --- 新增：木作櫃體 ---
        ["cab_wood_high", "木作", "05_櫃體", "木作高櫃 (高200)", "尺", 5800,
            "1.桶身製作：木芯板F3以上。\n2.結構加強：背板與牆面固定點需足夠。\n3.貼皮工藝：強力膠貼合，邊緣修飾。\n4.層板：活動層板孔位準確。",
            "1.垂直度：櫃體不傾斜。\n2.貼皮：無溢膠、起泡。\n3.味覺：無刺鼻甲醛味。",
            "無"],

        ["cab_wood_low", "木作", "05_櫃體", "木作低櫃 (高75)", "尺", 3800,
            "1.桶身製作：同高櫃。\n2.檯面處理：檯面需加強耐磨或使用強化玻璃/石材。\n3.抽屜：滑軌安裝水平。",
            "1.檯面平整：水平無誤差。\n2.抽屜：開關順滑。",
            "無"],

        ["cab_book", "木作", "05_櫃體", "木作書櫃 (開放式)", "尺", 3200,
            "1.層板跨距：跨距>90cm需加厚或加立板支撐，防微笑曲線。\n2.背板固定：防傾倒。",
            "1.層板強度：重壓不彎曲。\n2.防墜與耐震：建議有活動層板止滑設計。",
            "無"],

        // --- 新增：廁所門組 ---
        ["door_bath_lever", "木作", "06_門窗", "廁所門組 (喇叭鎖)", "組", 5500,
            "1.防水門框：立框，發泡填縫。\n2.防水門片：安裝塑鋼或防水木門。\n3.喇叭鎖：安裝鎖具。\n4.百葉/通風口：確認通風。",
            "1.防水性：下緣封邊完整。\n2.通風：下方留縫或有百葉。\n3.鎖具：反鎖功能正常。",
            "防水材質"],

        ["door_bath_turn", "木作", "06_門窗", "廁所門組 (一字鎖)", "組", 5200,
            "同喇叭鎖門組，鎖具改為一字鎖(硬幣可開)，安全性較高。",
            "同喇叭鎖門組，確認緊急開啟功能正常。",
            "無"],

        // --- 新增：其他常用木作 ---
        ["feat_screen", "木作", "04_牆面", "玄關屏風 (木作)", "尺", 2000,
            "1.結構固定：上下頂天立地固定確實。\n2.造型：格柵或玻璃鑲嵌。\n3.收邊：細膩打磨。",
            "1.穩固性：搖晃測試。\n2.透光性：玻璃乾淨無指紋。",
            "無"],

        ["ac_cover", "木作", "03_天花", "冷氣包管 (造型)", "尺", 550,
            "1.管線包覆：確認冷媒管、排水管已驗收。\n2.骨架：釘設木骨架。\n3.封板：矽酸鈣板或夾板。\n4.假樑：可做造型修飾。",
            "1.排水坡度：確認包管未壓迫排水管坡度。\n2.外觀：平直美觀。",
            "無"],

        ["elec_cover", "木作", "04_牆面", "電箱封板", "式", 2500,
            "1.邊框：木作修飾電箱周圍。\n2.門片：製作活動門片，磁吸固定。\n3.面材：同牆面材質延伸。",
            "1.開閉順暢：不卡住電箱蓋。\n2.美觀：縫隙隱藏。",
            "無"],

        ["sill_board", "木作", "04_牆面", "窗台板 (大理石紋)", "尺", 650,
            "1.底板：木芯板打底找平。\n2.貼面：貼美耐板或人造石。\n3.收邊：打矽利康防水。",
            "1.洩水坡度：窗邊往室內微斜或水平(避免積水導流)。\n2.防水：矽利康完整。",
            "無"],

        ["baseboard", "木作", "04_牆面", "踢腳線 (木質)", "尺", 180,
            "1.裁切：45度接角。\n2.固定：使用蚊釘槍或矽利康固定。",
            "1.服貼：緊貼牆面與地板，無明顯縫隙。\n2.接角：轉角密合。",
            "無"]
    ];
    writeToSheet(ss, "DB_Tasks", tasks);

    // ==========================================
    // 4. Map_Task_Materials (配方：材料與工法連結) - 完整版
    // ==========================================
    const mapMat = [
        // [TaskID, TaskName, MatID, SpecDesc, Qty, Loss, Consumable?, ToolTarget]

        // === 保護工程 ===
        // 雙層保護 (1坪)
        ["protect_floor_2", "地板保護 (雙層:瓦楞+夾板)", "m_protect_pp", "第一層瓦楞", 2.0, 1.1, "FALSE", "t_utility_knife"],
        ["protect_floor_2", "地板保護 (雙層:瓦楞+夾板)", "m_protect_ply", "第二層夾板", 1.0, 1.1, "FALSE", "t_drill_driver"],
        ["protect_floor_2", "地板保護 (雙層:瓦楞+夾板)", "m_tape_pvc", "固定膠帶", 0.5, 1.2, "TRUE", ""],
        // 單層保護 (1坪)
        ["protect_floor_1", "地板保護 (單層:瓦楞)", "m_protect_pp", "瓦楞板", 2.0, 1.1, "FALSE", ""],
        ["protect_floor_1", "地板保護 (單層:瓦楞)", "m_tape_pvc", "固定膠帶", 0.3, 1.2, "TRUE", ""],
        // 電梯/公設保護 (1式)
        ["protect_elev", "電梯/公設保護", "m_protect_pp", "瓦楞板", 10.0, 1.2, "FALSE", "t_utility_knife"],
        ["protect_elev", "電梯/公設保護", "m_protect_ply", "夾板", 5.0, 1.1, "FALSE", ""],
        ["protect_elev", "電梯/公設保護", "m_tape_pvc", "固定膠帶", 3.0, 1.2, "TRUE", ""],

        // === 天花板工程 ===
        // 平釘天花 (1坪)
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "m_lv_12_8", "天花骨架", 14.0, 1.1, "FALSE", "t_nail_422"],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "m_sil_6_36", "矽酸鈣板", 2.0, 1.1, "FALSE", "t_collated_scr"],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "m_ls_hanger", "吊筋", 4.0, 1.1, "FALSE", "t_hammer_rot"],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "m_glue_white", "白膠", 0.5, 1.2, "TRUE", ""],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "m_nail_422", "雙腳釘", 1.0, 1.2, "TRUE", ""],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "m_nail_st45", "鋼釘(吊筋)", 0.2, 1.2, "TRUE", ""],
        // 間接照明 (1尺)
        ["ceil_ind_lv", "間接照明天花板", "m_lv_12_8", "骨架", 2.0, 1.1, "FALSE", "t_nail_422"],
        ["ceil_ind_lv", "間接照明天花板", "m_ply_2_36", "立板/底板", 0.3, 1.2, "FALSE", "t_saw_table"],
        ["ceil_ind_lv", "間接照明天花板", "m_li_t5_4", "T5燈管", 0.25, 1.05, "FALSE", ""],
        ["ceil_ind_lv", "間接照明天花板", "m_nail_f30", "單針釘", 0.1, 1.2, "TRUE", ""],
        // 浴室PVC天花 (1坪)
        ["ceil_pvc_bath", "浴室PVC天花板", "m_pvc_12", "PVC防腐角材", 14.0, 1.1, "FALSE", "t_nail_j422"],
        ["ceil_pvc_bath", "浴室PVC天花板", "m_sil_6_tw", "PVC天花板", 2.0, 1.1, "FALSE", "t_jigsaw"],
        ["ceil_pvc_bath", "浴室PVC天花板", "m_sil_bio", "防霉矽利康", 2.0, 1.2, "TRUE", "t_caulk_gun"],
        ["ceil_pvc_bath", "浴室PVC天花板", "m_nail_j422", "不鏽鋼釘", 0.5, 1.2, "TRUE", ""],
        // 窗簾盒 (1尺)
        ["ceil_curtain", "窗簾盒 (木作)", "m_core_raw", "木心板", 0.15, 1.2, "FALSE", "t_saw_table"],
        ["ceil_curtain", "窗簾盒 (木作)", "m_lv_12_8", "角材補強", 0.5, 1.1, "FALSE", "t_nail_f50"],
        ["ceil_curtain", "窗簾盒 (木作)", "m_scr_chip_15", "木螺絲", 0.05, 1.2, "TRUE", "t_drill_imp"],
        ["ceil_curtain", "窗簾盒 (木作)", "m_putty_car", "補土", 0.02, 1.3, "TRUE", ""],

        // === 隔間與牆面 ===
        // 單面隔間 (1尺, 高度10尺)
        ["wall_1s_ply", "單面隔間 (夾板)", "m_lv_18_8", "角材立柱", 2.5, 1.1, "FALSE", "t_nail_st45"],
        ["wall_1s_ply", "單面隔間 (夾板)", "m_ply_2_36", "2分夾板", 0.5, 1.15, "FALSE", "t_nail_f30"],
        ["wall_1s_ply", "單面隔間 (夾板)", "m_nail_f50", "單針釘", 0.1, 1.2, "TRUE", ""],
        ["wall_1s_ply", "單面隔間 (夾板)", "m_glue_white", "白膠", 0.1, 1.2, "TRUE", ""],
        // 雙面隔間 (1尺)
        ["wall_2s_sil", "雙面隔間 (矽酸鈣+隔音)", "m_lv_18_8", "立柱結構", 3.0, 1.1, "FALSE", "t_nail_st45"],
        ["wall_2s_sil", "雙面隔間 (矽酸鈣+隔音)", "m_sil_9_36", "雙面封板", 0.6, 1.15, "FALSE", "t_collated_scr"],
        ["wall_2s_sil", "雙面隔間 (矽酸鈣+隔音)", "m_ls_rockwool", "隔音棉", 0.15, 1.1, "FALSE", "t_utility_knife"],
        ["wall_2s_sil", "雙面隔間 (矽酸鈣+隔音)", "m_glue_white", "白膠", 0.2, 1.2, "TRUE", ""],
        // 造型牆-實木皮 (1尺)
        ["wall_feat_ven", "造型牆 (實木皮)", "m_ply_3_36", "底板", 0.3, 1.15, "FALSE", "t_saw_table"],
        ["wall_feat_ven", "造型牆 (實木皮)", "m_veneer_oak", "實木皮", 0.5, 1.25, "FALSE", "t_iron"],
        ["wall_feat_ven", "造型牆 (實木皮)", "m_glue_yellow", "強力膠", 0.3, 1.3, "TRUE", "t_scraper"],
        ["wall_feat_ven", "造型牆 (實木皮)", "m_putty_car", "原子灰", 0.02, 1.3, "TRUE", ""],
        // 造型牆-美耐板 (1尺)
        ["wall_feat_lam", "造型牆 (美耐板)", "m_ply_3_36", "底板", 0.3, 1.15, "FALSE", "t_saw_table"],
        ["wall_feat_lam", "造型牆 (美耐板)", "m_lam_std", "美耐板", 0.5, 1.2, "FALSE", "t_router_fixed"],
        ["wall_feat_lam", "造型牆 (美耐板)", "m_glue_yellow", "強力膠", 0.3, 1.3, "TRUE", ""],
        ["wall_feat_lam", "造型牆 (美耐板)", "m_edge_pvc", "封邊條", 1.0, 1.2, "FALSE", ""],

        // === 地板工程 ===
        // 架高地板 (1坪)
        ["floor_raise_st", "架高地板 (結構)", "m_lv_12_8", "架高骨架", 18.0, 1.1, "FALSE", "t_nail_st45"],
        ["floor_raise_st", "架高地板 (結構)", "m_ply_5_36", "6分夾板", 2.0, 1.05, "FALSE", "t_saw_table"],
        ["floor_raise_st", "架高地板 (結構)", "m_fl_underlay", "防潮布", 0.1, 1.2, "TRUE", ""],
        ["floor_raise_st", "架高地板 (結構)", "m_sil_neut", "防異音膠", 1.0, 1.0, "TRUE", "t_caulk_gun"],
        // SPC石塑地板 (1坪)
        ["floor_spc", "SPC石塑地板 (直鋪)", "m_fl_spc_oak", "SPC地板", 1.0, 1.08, "FALSE", "t_mallet_rub"],
        ["floor_spc", "SPC石塑地板 (直鋪)", "m_fl_underlay", "靜音墊", 0.1, 1.1, "TRUE", ""],
        ["floor_spc", "SPC石塑地板 (直鋪)", "m_fl_trans", "起步條", 0.3, 1.1, "FALSE", ""],
        // 海島型木地板 (1坪)
        ["floor_eng", "海島型木地板 (平鋪)", "m_fl_eng_teak", "海島型木地板", 1.0, 1.08, "FALSE", "t_mallet_rub"],
        ["floor_eng", "海島型木地板 (平鋪)", "m_ply_4_36", "4分夾板底", 2.0, 1.1, "FALSE", "t_saw_table"],
        ["floor_eng", "海島型木地板 (平鋪)", "m_glue_white", "地板膠", 0.5, 1.2, "TRUE", ""],
        ["floor_eng", "海島型木地板 (平鋪)", "m_fl_trans", "起步條", 0.3, 1.1, "FALSE", ""],

        // === 櫃體工程 ===
        // 系統衣櫃 (1尺)
        ["cab_ward_sys", "系統衣櫃 (高240)", "m_hinge_110", "鉸鍊(每門4顆)", 1.5, 1.0, "FALSE", "t_drill_imp"],
        ["cab_ward_sys", "系統衣櫃 (高240)", "m_handle_alum", "把手", 1.0, 1.05, "FALSE", "t_saw_miter"],
        ["cab_ward_sys", "系統衣櫃 (高240)", "m_kd_cam", "結合五金", 6.0, 1.1, "FALSE", ""],
        ["cab_ward_sys", "系統衣櫃 (高240)", "m_adj_foot", "調整腳", 2.0, 1.0, "FALSE", ""],
        ["cab_ward_sys", "系統衣櫃 (高240)", "m_rod_hang", "吊衣桿", 1.0, 1.0, "FALSE", ""],
        ["cab_ward_sys", "系統衣櫃 (高240)", "m_rod_seat", "吊衣桿座", 2.0, 1.0, "FALSE", ""],
        ["cab_ward_sys", "系統衣櫃 (高240)", "m_shelf_pin", "銅珠", 8.0, 1.1, "FALSE", ""],
        // 系統鞋櫃 (1尺)
        ["cab_shoe_sys", "系統鞋櫃 (高100)", "m_hinge_110", "鉸鍊", 1.0, 1.0, "FALSE", "t_drill_imp"],
        ["cab_shoe_sys", "系統鞋櫃 (高100)", "m_handle_knob", "把手", 0.5, 1.0, "FALSE", ""],
        ["cab_shoe_sys", "系統鞋櫃 (高100)", "m_kd_cam", "結合五金", 4.0, 1.1, "FALSE", ""],
        ["cab_shoe_sys", "系統鞋櫃 (高100)", "m_adj_foot", "調整腳", 1.5, 1.0, "FALSE", ""],
        ["cab_shoe_sys", "系統鞋櫃 (高100)", "m_shelf_pin", "銅珠", 6.0, 1.1, "FALSE", ""],
        // 木作電視櫃 (1尺)
        ["cab_tv_wood", "木作電視櫃 (懸空)", "m_core_liu", "木心板桶身", 1.2, 1.2, "FALSE", "t_saw_table"],
        ["cab_tv_wood", "木作電視櫃 (懸空)", "m_veneer_oak", "貼皮", 1.2, 1.2, "FALSE", "t_iron"],
        ["cab_tv_wood", "木作電視櫃 (懸空)", "m_glue_yellow", "強力膠", 0.5, 1.3, "TRUE", "t_scraper"],
        ["cab_tv_wood", "木作電視櫃 (懸空)", "m_edge_pvc", "封邊", 5.0, 1.2, "FALSE", ""],
        ["cab_tv_wood", "木作電視櫃 (懸空)", "m_slide_under", "滑軌", 0.5, 1.0, "FALSE", "t_drill_driver"],
        ["cab_tv_wood", "木作電視櫃 (懸空)", "m_scr_chip_15", "木螺絲", 0.2, 1.2, "TRUE", ""],
        // 廚具上櫃 (1cm寬)
        ["cab_kitch_u", "廚具上櫃", "m_hinge_110", "鉸鍊", 0.08, 1.0, "FALSE", "t_drill_imp"],
        ["cab_kitch_u", "廚具上櫃", "m_handle_alum", "把手", 0.02, 1.05, "FALSE", ""],
        ["cab_kitch_u", "廚具上櫃", "m_core_poly1", "波麗板", 0.02, 1.15, "FALSE", "t_saw_table"],
        ["cab_kitch_u", "廚具上櫃", "m_scr_chip_12", "木螺絲", 0.01, 1.2, "TRUE", ""],
        // 廚具下櫃 (1cm寬)
        ["cab_kitch_l", "廚具下櫃 (不含三機)", "m_hinge_110", "鉸鍊", 0.06, 1.0, "FALSE", "t_drill_imp"],
        ["cab_kitch_l", "廚具下櫃 (不含三機)", "m_slide_ball", "滑軌", 0.02, 1.0, "FALSE", ""],
        ["cab_kitch_l", "廚具下櫃 (不含三機)", "m_handle_alum", "把手", 0.02, 1.05, "FALSE", ""],
        ["cab_kitch_l", "廚具下櫃 (不含三機)", "m_core_poly2", "防水板", 0.03, 1.15, "FALSE", "t_saw_table"],
        ["cab_kitch_l", "廚具下櫃 (不含三機)", "m_sil_bio", "矽利康", 0.02, 1.2, "TRUE", "t_caulk_gun"],

        // === 門窗工程 ===
        // 房間門組 (1組)
        ["door_room_set", "房間門組 (便品)", "m_lock_cyl", "門鎖", 1.0, 1.0, "FALSE", "t_hole_saw"],
        ["door_room_set", "房間門組 (便品)", "m_hinge_110", "門鉸鍊", 3.0, 1.0, "FALSE", "t_chisel_set"],
        ["door_room_set", "房間門組 (便品)", "m_door_stpr", "門擋", 1.0, 1.0, "FALSE", ""],
        ["door_room_set", "房間門組 (便品)", "m_foam_pu", "發泡劑(門框)", 0.5, 1.2, "TRUE", ""],
        ["door_room_set", "房間門組 (便品)", "m_sil_neut", "矽利康(收邊)", 1.0, 1.2, "TRUE", "t_caulk_gun"],
        // 穀倉門 (1組)
        ["door_barn", "穀倉門 (滑門)", "m_core_raw", "門片積層", 2.0, 1.1, "FALSE", "t_saw_table"],
        ["door_barn", "穀倉門 (滑門)", "m_veneer_wal", "表面貼皮", 2.0, 1.2, "FALSE", "t_iron"],
        ["door_barn", "穀倉門 (滑門)", "m_lock_cyl", "門鎖(視需求)", 1.0, 1.0, "FALSE", "t_hole_saw"],
        ["door_barn", "穀倉門 (滑門)", "m_door_stpr", "止擺/門擋", 1.0, 1.0, "FALSE", ""],
        // 隱藏門 (1組)
        ["pocket_door", "隱藏門 (暗門)", "m_core_liu", "門片基材", 1.5, 1.15, "FALSE", "t_saw_table"],
        ["pocket_door", "隱藏門 (暗門)", "m_veneer_oak", "同牆面材", 1.5, 1.2, "FALSE", "t_iron"],
        ["pocket_door", "隱藏門 (暗門)", "m_hinge_165", "回歸鉸鍊", 3.0, 1.0, "FALSE", "t_chisel_set"],
        ["pocket_door", "隱藏門 (暗門)", "m_glue_yellow", "強力膠", 0.5, 1.3, "TRUE", ""],
        ["pocket_door", "隱藏門 (暗門)", "m_putty_car", "原子灰", 0.1, 1.3, "TRUE", ""],

        // === 新增工項配方 ===

        // 木作高櫃 (1尺)
        ["cab_wood_high", "木作高櫃 (高200)", "m_core_liu", "木心板桶身", 1.8, 1.2, "FALSE", "t_saw_table"],
        ["cab_wood_high", "木作高櫃 (高200)", "m_veneer_oak", "貼皮", 1.8, 1.25, "FALSE", "t_iron"],
        ["cab_wood_high", "木作高櫃 (高200)", "m_glue_yellow", "強力膠", 0.6, 1.3, "TRUE", ""],
        ["cab_wood_high", "木作高櫃 (高200)", "m_hinge_110", "緩衝鉸鍊", 2.0, 1.0, "FALSE", "t_drill_imp"],
        ["cab_wood_high", "木作高櫃 (高200)", "m_handle_alum", "把手", 1.0, 1.05, "FALSE", ""],
        ["cab_wood_high", "木作高櫃 (高200)", "m_shelf_pin", "銅珠", 10.0, 1.1, "FALSE", ""],
        ["cab_wood_high", "木作高櫃 (高200)", "m_scr_chip_15", "木螺絲", 0.3, 1.2, "TRUE", ""],

        // 木作低櫃 (1尺)
        ["cab_wood_low", "木作低櫃 (高75)", "m_core_liu", "木心板桶身", 0.8, 1.2, "FALSE", "t_saw_table"],
        ["cab_wood_low", "木作低櫃 (高75)", "m_veneer_oak", "貼皮", 0.8, 1.25, "FALSE", "t_iron"],
        ["cab_wood_low", "木作低櫃 (高75)", "m_glue_yellow", "強力膠", 0.3, 1.3, "TRUE", ""],
        ["cab_wood_low", "木作低櫃 (高75)", "m_hinge_110", "緩衝鉸鍊", 1.5, 1.0, "FALSE", "t_drill_imp"],
        ["cab_wood_low", "木作低櫃 (高75)", "m_slide_under", "隱藏式滑軌", 0.5, 1.0, "FALSE", ""],
        ["cab_wood_low", "木作低櫃 (高75)", "m_adj_foot", "調整腳", 2.0, 1.0, "FALSE", ""],

        // 木作書櫃 (1尺)
        ["cab_book", "木作書櫃 (開放式)", "m_core_liu", "木心板", 1.0, 1.2, "FALSE", "t_saw_table"],
        ["cab_book", "木作書櫃 (開放式)", "m_veneer_oak", "貼皮", 1.0, 1.25, "FALSE", "t_iron"],
        ["cab_book", "木作書櫃 (開放式)", "m_glue_yellow", "強力膠", 0.4, 1.3, "TRUE", ""],
        ["cab_book", "木作書櫃 (開放式)", "m_shelf_pin", "銅珠(活動層板)", 8.0, 1.1, "FALSE", ""],
        ["cab_book", "木作書櫃 (開放式)", "m_edge_pvc", "封邊條", 3.0, 1.2, "FALSE", ""],

        // 廁所門組-喇叭鎖 (1組)
        ["door_bath_lever", "廁所門組 (喇叭鎖)", "m_core_poly1", "防水門片", 1.0, 1.0, "FALSE", "t_saw_table"],
        ["door_bath_lever", "廁所門組 (喇叭鎖)", "m_lock_lever", "喇叭鎖", 1.0, 1.0, "FALSE", "t_hole_saw"],
        ["door_bath_lever", "廁所門組 (喇叭鎖)", "m_hinge_bath", "浴室專用鉸鍊", 3.0, 1.0, "FALSE", "t_chisel_set"],
        ["door_bath_lever", "廁所門組 (喇叭鎖)", "m_foam_pu", "發泡劑(門框)", 0.5, 1.2, "TRUE", ""],
        ["door_bath_lever", "廁所門組 (喇叭鎖)", "m_sil_bio", "防霉矽利康", 1.0, 1.2, "TRUE", "t_caulk_gun"],

        // 廁所門組-一字鎖 (1組)
        ["door_bath_turn", "廁所門組 (一字鎖)", "m_core_poly1", "防水門片", 1.0, 1.0, "FALSE", "t_saw_table"],
        ["door_bath_turn", "廁所門組 (一字鎖)", "m_lock_turn", "一字鎖", 1.0, 1.0, "FALSE", "t_hole_saw"],
        ["door_bath_turn", "廁所門組 (一字鎖)", "m_hinge_bath", "浴室專用鉸鍊", 3.0, 1.0, "FALSE", "t_chisel_set"],
        ["door_bath_turn", "廁所門組 (一字鎖)", "m_foam_pu", "發泡劑(門框)", 0.5, 1.2, "TRUE", ""],
        ["door_bath_turn", "廁所門組 (一字鎖)", "m_sil_bio", "防霉矽利康", 1.0, 1.2, "TRUE", "t_caulk_gun"],

        // 玄關屏風 (1尺)
        ["feat_screen", "玄關屏風 (木作)", "m_lv_18_8", "角材骨架", 3.0, 1.1, "FALSE", "t_nail_f50"],
        ["feat_screen", "玄關屏風 (木作)", "m_ply_3_36", "底板", 0.4, 1.15, "FALSE", "t_saw_table"],
        ["feat_screen", "玄關屏風 (木作)", "m_veneer_oak", "雙面貼皮", 0.8, 1.25, "FALSE", "t_iron"],
        ["feat_screen", "玄關屏風 (木作)", "m_glue_yellow", "強力膠", 0.4, 1.3, "TRUE", ""],

        // 冷氣包管 (1尺)
        ["ac_cover", "冷氣包管 (造型)", "m_core_raw", "木心板", 0.2, 1.2, "FALSE", "t_saw_table"],
        ["ac_cover", "冷氣包管 (造型)", "m_sil_6_36", "矽酸鈣板", 0.15, 1.15, "FALSE", "t_collated_scr"],
        ["ac_cover", "冷氣包管 (造型)", "m_putty_wall", "批土", 0.05, 1.3, "TRUE", ""],
        ["ac_cover", "冷氣包管 (造型)", "m_nail_f30", "單針釘", 0.05, 1.2, "TRUE", ""],

        // 電箱封板 (1式)
        ["elec_cover", "電箱封板", "m_core_raw", "木心板門片", 0.5, 1.2, "FALSE", "t_saw_table"],
        ["elec_cover", "電箱封板", "m_veneer_oak", "貼皮", 0.5, 1.25, "FALSE", "t_iron"],
        ["elec_cover", "電箱封板", "m_hinge_blind", "隱藏鉸鍊", 2.0, 1.0, "FALSE", "t_drill_imp"],
        ["elec_cover", "電箱封板", "m_magnet", "磁吸扣", 2.0, 1.0, "FALSE", ""],

        // 窗台板 (1尺)
        ["sill_board", "窗台板 (大理石紋)", "m_ply_4_36", "底板", 0.15, 1.15, "FALSE", "t_saw_table"],
        ["sill_board", "窗台板 (大理石紋)", "m_lam_std", "美耐板/人造石", 0.15, 1.2, "FALSE", "t_router_fixed"],
        ["sill_board", "窗台板 (大理石紋)", "m_glue_yellow", "強力膠", 0.1, 1.3, "TRUE", ""],
        ["sill_board", "窗台板 (大理石紋)", "m_sil_neut", "矽利康(防水)", 0.2, 1.2, "TRUE", "t_caulk_gun"],

        // 踢腳線 (1尺)
        ["baseboard", "踢腳線 (木質)", "m_kick_wood", "木質踢腳線", 1.0, 1.1, "FALSE", "t_saw_miter"],
        ["baseboard", "踢腳線 (木質)", "m_nail_p22", "蚊釘", 0.05, 1.2, "TRUE", "t_nail_p22"],
        ["baseboard", "踢腳線 (木質)", "m_sil_neut", "矽利康(收邊)", 0.1, 1.2, "TRUE", "t_caulk_gun"]
    ];
    writeToSheet(ss, "Map_Task_Materials", mapMat);

    // ==========================================
    // 5. Map_Task_Tools (工具分配) - 完整版
    // ==========================================
    const mapTools = [
        // [TaskID, TaskName, ToolID, Type, Qty, CalcMethod]

        // === 保護工程 ===
        ["protect_floor_2", "地板保護 (雙層:瓦楞+夾板)", "t_utility_knife", "必備", 1, "PerWorker"],
        ["protect_floor_2", "地板保護 (雙層:瓦楞+夾板)", "t_tape_disp", "必備", 1, "Fixed"],
        ["protect_floor_1", "地板保護 (單層:瓦楞)", "t_utility_knife", "必備", 1, "PerWorker"],
        ["protect_elev", "電梯/公設保護", "t_utility_knife", "必備", 2, "PerWorker"],
        ["protect_elev", "電梯/公設保護", "t_tape_disp", "必備", 2, "Fixed"],

        // === 天花板工程 ===
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "t_nail_422", "必備", 1, "Fixed"],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "t_laser_green", "必備", 1, "Fixed"],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "t_ladder_a", "必備", 2, "Fixed"],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "t_collated_scr", "必備", 1, "Fixed"],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "t_hammer_rot", "必備", 1, "Fixed"],
        ["ceil_flat_lv", "平釘天花板 (矽酸鈣)", "t_saw_miter", "必備", 1, "Fixed"],
        ["ceil_ind_lv", "間接照明天花板", "t_nail_422", "必備", 1, "Fixed"],
        ["ceil_ind_lv", "間接照明天花板", "t_saw_table", "必備", 1, "Fixed"],
        ["ceil_ind_lv", "間接照明天花板", "t_laser_green", "必備", 1, "Fixed"],
        ["ceil_pvc_bath", "浴室PVC天花板", "t_nail_422", "必備", 1, "Fixed"],
        ["ceil_pvc_bath", "浴室PVC天花板", "t_jigsaw", "必備", 1, "Fixed"],
        ["ceil_pvc_bath", "浴室PVC天花板", "t_caulk_gun", "必備", 1, "PerWorker"],
        ["ceil_curtain", "窗簾盒 (木作)", "t_saw_table", "必備", 1, "Fixed"],
        ["ceil_curtain", "窗簾盒 (木作)", "t_nail_f50", "必備", 1, "Fixed"],
        ["ceil_curtain", "窗簾盒 (木作)", "t_drill_imp", "必備", 1, "PerWorker"],

        // === 隔間與牆面 ===
        ["wall_1s_ply", "單面隔間 (夾板)", "t_nail_st64", "必備", 1, "Fixed"],
        ["wall_1s_ply", "單面隔間 (夾板)", "t_nail_f30", "必備", 1, "Fixed"],
        ["wall_1s_ply", "單面隔間 (夾板)", "t_saw_miter", "必備", 1, "Fixed"],
        ["wall_2s_sil", "雙面隔間 (矽酸鈣+隔音)", "t_nail_st64", "必備", 1, "Fixed"],
        ["wall_2s_sil", "雙面隔間 (矽酸鈣+隔音)", "t_collated_scr", "必備", 1, "Fixed"],
        ["wall_2s_sil", "雙面隔間 (矽酸鈣+隔音)", "t_utility_knife", "必備", 1, "PerWorker"],
        ["wall_feat_ven", "造型牆 (實木皮)", "t_saw_table", "必備", 1, "Fixed"],
        ["wall_feat_ven", "造型牆 (實木皮)", "t_iron", "必備", 1, "Fixed"],
        ["wall_feat_ven", "造型牆 (實木皮)", "t_sander_orb", "必備", 1, "Fixed"],
        ["wall_feat_lam", "造型牆 (美耐板)", "t_saw_table", "必備", 1, "Fixed"],
        ["wall_feat_lam", "造型牆 (美耐板)", "t_router_fixed", "必備", 1, "Fixed"],

        // === 地板工程 ===
        ["floor_raise_st", "架高地板 (結構)", "t_laser_floor", "必備", 1, "Fixed"],
        ["floor_raise_st", "架高地板 (結構)", "t_nail_st64", "必備", 1, "Fixed"],
        ["floor_raise_st", "架高地板 (結構)", "t_saw_table", "必備", 1, "Fixed"],
        ["floor_spc", "SPC石塑地板 (直鋪)", "t_mallet_rub", "必備", 1, "PerWorker"],
        ["floor_spc", "SPC石塑地板 (直鋪)", "t_utility_knife", "必備", 1, "PerWorker"],
        ["floor_spc", "SPC石塑地板 (直鋪)", "t_tape_5m", "必備", 1, "PerWorker"],
        ["floor_eng", "海島型木地板 (平鋪)", "t_mallet_rub", "必備", 1, "PerWorker"],
        ["floor_eng", "海島型木地板 (平鋪)", "t_saw_table", "必備", 1, "Fixed"],
        ["floor_eng", "海島型木地板 (平鋪)", "t_nail_p22", "選用", 1, "Fixed"],

        // === 櫃體工程 ===
        ["cab_ward_sys", "系統衣櫃 (高240)", "t_drill_imp", "必備", 1, "PerWorker"],
        ["cab_ward_sys", "系統衣櫃 (高240)", "t_level_60", "必備", 1, "PerWorker"],
        ["cab_ward_sys", "系統衣櫃 (高240)", "t_shim_plast", "必備", 1, "Dynamic"],
        ["cab_shoe_sys", "系統鞋櫃 (高100)", "t_drill_imp", "必備", 1, "PerWorker"],
        ["cab_shoe_sys", "系統鞋櫃 (高100)", "t_level_60", "必備", 1, "PerWorker"],
        ["cab_tv_wood", "木作電視櫃 (懸空)", "t_saw_table", "必備", 1, "Fixed"],
        ["cab_tv_wood", "木作電視櫃 (懸空)", "t_jig_pocket", "選用", 1, "Fixed"],
        ["cab_tv_wood", "木作電視櫃 (懸空)", "t_iron", "必備", 1, "Fixed"],
        ["cab_tv_wood", "木作電視櫃 (懸空)", "t_drill_driver", "必備", 1, "PerWorker"],
        ["cab_kitch_u", "廚具上櫃", "t_drill_imp", "必備", 1, "PerWorker"],
        ["cab_kitch_u", "廚具上櫃", "t_level_60", "必備", 1, "PerWorker"],
        ["cab_kitch_l", "廚具下櫃 (不含三機)", "t_drill_imp", "必備", 1, "PerWorker"],
        ["cab_kitch_l", "廚具下櫃 (不含三機)", "t_level_60", "必備", 1, "PerWorker"],
        ["cab_kitch_l", "廚具下櫃 (不含三機)", "t_caulk_gun", "必備", 1, "PerWorker"],

        // === 門窗工程 ===
        ["door_room_set", "房間門組 (便品)", "t_hole_saw", "必備", 1, "Fixed"],
        ["door_room_set", "房間門組 (便品)", "t_chisel_set", "必備", 1, "PerWorker"],
        ["door_room_set", "房間門組 (便品)", "t_level_60", "必備", 1, "PerWorker"],
        ["door_room_set", "房間門組 (便品)", "t_caulk_gun", "必備", 1, "PerWorker"],
        ["door_barn", "穀倉門 (滑門)", "t_saw_table", "必備", 1, "Fixed"],
        ["door_barn", "穀倉門 (滑門)", "t_iron", "必備", 1, "Fixed"],
        ["door_barn", "穀倉門 (滑門)", "t_router_plunge", "必備", 1, "Fixed"],
        ["door_barn", "穀倉門 (滑門)", "t_drill_imp", "必備", 1, "PerWorker"],
        ["pocket_door", "隱藏門 (暗門)", "t_saw_table", "必備", 1, "Fixed"],
        ["pocket_door", "隱藏門 (暗門)", "t_chisel_set", "必備", 1, "PerWorker"],
        ["pocket_door", "隱藏門 (暗門)", "t_iron", "必備", 1, "Fixed"],
        ["pocket_door", "隱藏門 (暗門)", "t_router_plunge", "選用", 1, "Fixed"],

        // === 新增工項工具配方 ===

        // 木作高櫃
        ["cab_wood_high", "木作高櫃 (高200)", "t_saw_table", "必備", 1, "Fixed"],
        ["cab_wood_high", "木作高櫃 (高200)", "t_iron", "必備", 1, "Fixed"],
        ["cab_wood_high", "木作高櫃 (高200)", "t_drill_imp", "必備", 1, "PerWorker"],
        ["cab_wood_high", "木作高櫃 (高200)", "t_level_60", "必備", 1, "PerWorker"],

        // 木作低櫃
        ["cab_wood_low", "木作低櫃 (高75)", "t_saw_table", "必備", 1, "Fixed"],
        ["cab_wood_low", "木作低櫃 (高75)", "t_iron", "必備", 1, "Fixed"],
        ["cab_wood_low", "木作低櫃 (高75)", "t_drill_imp", "必備", 1, "PerWorker"],
        ["cab_wood_low", "木作低櫃 (高75)", "t_level_60", "必備", 1, "PerWorker"],

        // 木作書櫃
        ["cab_book", "木作書櫃 (開放式)", "t_saw_table", "必備", 1, "Fixed"],
        ["cab_book", "木作書櫃 (開放式)", "t_iron", "必備", 1, "Fixed"],
        ["cab_book", "木作書櫃 (開放式)", "t_drill_driver", "必備", 1, "PerWorker"],

        // 廁所門組-喇叭鎖
        ["door_bath_lever", "廁所門組 (喇叭鎖)", "t_hole_saw", "必備", 1, "Fixed"],
        ["door_bath_lever", "廁所門組 (喇叭鎖)", "t_chisel_set", "必備", 1, "PerWorker"],
        ["door_bath_lever", "廁所門組 (喇叭鎖)", "t_caulk_gun", "必備", 1, "PerWorker"],
        ["door_bath_lever", "廁所門組 (喇叭鎖)", "t_level_60", "必備", 1, "PerWorker"],

        // 廁所門組-一字鎖
        ["door_bath_turn", "廁所門組 (一字鎖)", "t_hole_saw", "必備", 1, "Fixed"],
        ["door_bath_turn", "廁所門組 (一字鎖)", "t_chisel_set", "必備", 1, "PerWorker"],
        ["door_bath_turn", "廁所門組 (一字鎖)", "t_caulk_gun", "必備", 1, "PerWorker"],
        ["door_bath_turn", "廁所門組 (一字鎖)", "t_level_60", "必備", 1, "PerWorker"],

        // 玄關屏風
        ["feat_screen", "玄關屏風 (木作)", "t_saw_table", "必備", 1, "Fixed"],
        ["feat_screen", "玄關屏風 (木作)", "t_nail_f50", "必備", 1, "Fixed"],
        ["feat_screen", "玄關屏風 (木作)", "t_iron", "必備", 1, "Fixed"],

        // 冷氣包管
        ["ac_cover", "冷氣包管 (造型)", "t_saw_table", "必備", 1, "Fixed"],
        ["ac_cover", "冷氣包管 (造型)", "t_collated_scr", "必備", 1, "Fixed"],
        ["ac_cover", "冷氣包管 (造型)", "t_ladder_a", "必備", 1, "Fixed"],

        // 電箱封板
        ["elec_cover", "電箱封板", "t_saw_table", "必備", 1, "Fixed"],
        ["elec_cover", "電箱封板", "t_iron", "必備", 1, "Fixed"],
        ["elec_cover", "電箱封板", "t_drill_imp", "必備", 1, "PerWorker"],

        // 窗台板
        ["sill_board", "窗台板 (大理石紋)", "t_saw_table", "必備", 1, "Fixed"],
        ["sill_board", "窗台板 (大理石紋)", "t_router_fixed", "必備", 1, "Fixed"],
        ["sill_board", "窗台板 (大理石紋)", "t_caulk_gun", "必備", 1, "PerWorker"],

        // 踢腳線
        ["baseboard", "踢腳線 (木質)", "t_saw_miter", "必備", 1, "Fixed"],
        ["baseboard", "踢腳線 (木質)", "t_nail_p22", "必備", 1, "Fixed"],
        ["baseboard", "踢腳線 (木質)", "t_caulk_gun", "必備", 1, "PerWorker"],

        // === 木作基本進場工具 (t_basic) ===
        // A. 動力設備
        ["t_basic", "[木作]基本進場工具", "t_comp_2hp", "必備", 1, "Fixed"],
        ["t_basic", "[木作]基本進場工具", "t_saw_table", "必備", 1, "Fixed"],
        ["t_basic", "[木作]基本進場工具", "t_saw_miter", "必備", 1, "Fixed"],
        // B. 氣動工具
        ["t_basic", "[木作]基本進場工具", "t_nail_f50", "必備", 1, "Fixed"],
        ["t_basic", "[木作]基本進場工具", "t_nail_422", "必備", 1, "Fixed"],
        ["t_basic", "[木作]基本進場工具", "t_nail_st64", "必備", 1, "Fixed"],
        // C. 電動手工具
        ["t_basic", "[木作]基本進場工具", "t_drill_imp", "必備", 1, "PerWorker"],
        ["t_basic", "[木作]基本進場工具", "t_jigsaw", "選配", 1, "Fixed"],
        // D. 測量工具
        ["t_basic", "[木作]基本進場工具", "t_laser_green", "必備", 1, "Fixed"],
        ["t_basic", "[木作]基本進場工具", "t_level_60", "必備", 1, "PerWorker"],
        ["t_basic", "[木作]基本進場工具", "t_tape_5m", "必備", 1, "PerWorker"],
        ["t_basic", "[木作]基本進場工具", "t_angle_ruler", "必備", 1, "PerWorker"],
        ["t_basic", "[木作]基本進場工具", "t_ink_marker", "必備", 1, "PerWorker"],
        // E. 手工具
        ["t_basic", "[木作]基本進場工具", "t_hammer_claw", "必備", 1, "PerWorker"],
        ["t_basic", "[木作]基本進場工具", "t_mallet_rub", "必備", 1, "PerWorker"],
        ["t_basic", "[木作]基本進場工具", "t_utility_knife", "必備", 1, "PerWorker"],
        ["t_basic", "[木作]基本進場工具", "t_caulk_gun", "必備", 1, "PerWorker"],
        // F. 設施
        ["t_basic", "[木作]基本進場工具", "t_ladder_a", "必備", 2, "Fixed"],
        ["t_basic", "[木作]基本進場工具", "t_ext_cord", "必備", 2, "Fixed"],
        ["t_basic", "[木作]基本進場工具", "t_work_light", "必備", 1, "Fixed"],
        // G. 個人防護
        ["t_basic", "[木作]基本進場工具", "t_helmet", "必備", 1, "PerWorker"],
        ["t_basic", "[木作]基本進場工具", "t_goggle", "必備", 1, "PerWorker"],
        ["t_basic", "[木作]基本進場工具", "t_mask_n95", "必備", 1, "PerWorker"]
    ];
    writeToSheet(ss, "Map_Task_Tools", mapTools);

    console.log("資料寫入完成");
}

function writeToSheet(ss, name, data) {
    const sheet = ss.getSheetByName(name);
    if (!sheet) return;
    const lastRow = sheet.getLastRow();
    // 清除舊資料，但保留標題列
    // [重要] 使用 clearContent() 並不會刪除列，而是清空內容
    // 我們每次都是從第2列開始寫，若舊資料比新資料多，
    // 必須確保多出的舊資料也被清掉。

    // 策略：先清空從第2列到底部所有內容
    if (lastRow > 1) {
        // 檢查是否有篩選器，若有則先移除，避免刪除錯誤
        if (sheet.getFilter()) {
            sheet.getFilter().remove();
        }
        sheet.getRange(2, 1, sheet.getMaxRows() - 1, sheet.getLastColumn()).clearContent();
    }

    // 寫入新資料
    if (data.length > 0) {
        sheet.getRange(2, 1, data.length, data[0].length).setValues(data);
    }
}



// 轉接函式：提供 backend_script.js 呼叫的統一入口
function setupDB() {
    console.log("Starting setupDB (v2.2 wrapper)...");
    setupDatabase();  // 建立工作表結構
    seedSampleData(); // 寫入詳細樣本資料
    return "Database initialized successfully (v2.2)";
}
